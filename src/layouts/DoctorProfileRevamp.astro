---
/**
 * MDRPedia — Premium Doctor Profile Layout
 * A world-class medical professional profile experience
 */

import Layout from "./Layout.astro";
import JsonLd from "../components/JsonLd.astro";
import MedicalKnowledgeGraph from "../components/MedicalKnowledgeGraph.astro";
import TierBadge from "../components/TierBadge.astro";
import SimilarDoctors from "../components/SimilarDoctors.astro";
import ShareProfileModal from "../components/ShareProfileModal";
import ImpactVoteButton from "../components/ImpactVoteButton";
import { generateAISummary } from "../lib/ai-summary";

// Premium Components
import MediaVault from "../components/MediaVault.astro";
import MedicalLineageGraph from "../components/MedicalLineageGraph";
import AwardsRibbon from "../components/AwardsRibbon.astro";
import LegacyTimeline from "../components/LegacyTimeline.astro";
import ProfileEmbed from "../components/ProfileEmbed.astro";

// AI-Optimized Content Components (Phase 1)
import ELI5Summary from "../components/AI/ELI5Summary.astro";
import TechniqueBreakdown from "../components/AI/TechniqueBreakdown.astro";
import VerifiedClaims from "../components/AI/VerifiedClaims.astro";
import EnhancedFAQ from "../components/AI/EnhancedFAQ.astro";
import ImpactMetricsTable from "../components/AI/ImpactMetricsTable.astro";
import ControversiesTimeline from "../components/AI/ControversiesTimeline.astro";
import MisconceptionsTable from "../components/AI/MisconceptionsTable.astro";
import ClinicalScenarios from "../components/AI/ClinicalScenarios.astro";
import AIContentSchema from "../components/AI/AIContentSchema.astro";
import HiddenAIContext from "../components/SEO/HiddenAIContext.astro";

// AI-Optimized Content Components (Phase 2)
import MentorshipTree from "../components/AI/MentorshipTree.astro";
import CitationContexts from "../components/AI/CitationContexts.astro";
import FailureAnalysis from "../components/AI/FailureAnalysis.astro";
import MedicalLexiconTags from "../components/AI/MedicalLexiconTags.astro";
import FutureOutlook from "../components/AI/FutureOutlook.astro";
import PatientJourneyMap from "../components/AI/PatientJourneyMap.astro";
import ComparativeMatrix from "../components/AI/ComparativeMatrix.astro";
import DataExportPanel from "../components/AI/DataExportPanel.astro";
import KeyInsights from "../components/AI/KeyInsights.astro";
import InstitutionalEcosystem from "../components/AI/InstitutionalEcosystem.astro";

// AI-Optimized Content Components (Phase 3)
import OffLabelTracker from "../components/AI/OffLabelTracker.astro";
import MedicalDiffs from "../components/AI/MedicalDiffs.astro";

import type { ProfileData } from "../lib/types";
import { getInstitutionLogo, getInstitutionInitials, getInstitutionColor } from "../lib/institution-logos";

interface Props {
    doctor: ProfileData;
    profileId?: string;
}

const { doctor, profileId } = Astro.props;

// --- Data Preparation ---
const isHistorical = doctor.status === "HISTORICAL";
const hasImage = doctor.portraitUrl && !doctor.portraitUrl.startsWith("data:image/svg");
const initials = doctor.fullName
    .split(" ")
    .map((w) => w[0])
    .filter((_, i) => i < 2)
    .join("")
    .toUpperCase();

const location = [doctor.geography.city, doctor.geography.region, doctor.geography.country]
    .filter(Boolean)
    .filter(v => v !== "Unknown")
    .join(", ") || doctor.geography.country;

// Total Citations - handle both citationCount and totalCitationCount field names
const totalCitations = doctor.citations?.reduce((acc, curr) => {
    const count = curr.citationCount ?? curr.totalCitationCount ?? 0;
    return acc + count;
}, 0) || 0;

// Total Impact with time-based growth
const baseImpact = doctor.totalImpact || Math.floor(
    (doctor.livesSaved * 1.5) +
    doctor.verifiedSurgeries +
    (totalCitations / 50) +
    (doctor.hIndex * 10)
);
const timeGrowth = 1 + (doctor.yearsActive * 0.005);
const dayOfYear = Math.floor((Date.now() - new Date(new Date().getFullYear(), 0, 0).getTime()) / 86400000);
const totalImpact = Math.floor(baseImpact * timeGrowth) + Math.floor((baseImpact * 0.0001) * (dayOfYear % 30));

// AI Summary with fallback
const aiSummary = doctor.aiSummary || generateAISummary({
    fullName: doctor.fullName,
    specialty: doctor.specialty,
    subSpecialty: doctor.subSpecialty || undefined,
    tier: doctor.tier,
    hIndex: doctor.hIndex,
    yearsActive: doctor.yearsActive,
    verifiedSurgeries: doctor.verifiedSurgeries,
    livesSaved: doctor.livesSaved,
    techniquesInvented: doctor.techniquesInvented,
    geography: {
        country: doctor.geography.country,
        region: doctor.geography.region || undefined,
        city: doctor.geography.city || undefined,
    },
    affiliations: doctor.affiliations?.map((a) => ({
        hospitalName: a.hospitalName,
        role: a.role || undefined,
        hospitalUrl: a.hospitalUrl || undefined,
    })),
    biography: doctor.biography || undefined,
    status: doctor.status,
    dateOfBirth: doctor.dateOfBirth || undefined,
    dateOfDeath: doctor.dateOfDeath || undefined,
    citations: doctor.citations,
    awards: doctor.awards,
});

// Tier gradients
const tierGradients: Record<string, string> = {
    TITAN: "linear-gradient(135deg, rgba(255, 215, 0, 0.08) 0%, rgba(138, 43, 226, 0.12) 100%)",
    ELITE: "linear-gradient(135deg, rgba(0, 112, 243, 0.08) 0%, rgba(0, 200, 255, 0.08) 100%)",
    MASTER: "linear-gradient(135deg, rgba(0, 204, 102, 0.08) 0%, rgba(16, 185, 129, 0.08) 100%)",
    UNRANKED: "linear-gradient(135deg, rgba(100, 100, 120, 0.05) 0%, rgba(60, 60, 80, 0.05) 100%)",
};

const heroGradient = tierGradients[doctor.tier] || tierGradients.UNRANKED;
const slug = Astro.url.pathname.split("/").filter(Boolean).pop() || "";

// Computed data quality flags
const hasMeaningfulBio = doctor.biography && doctor.biography.length > 50;
const hasAffiliations = doctor.affiliations && doctor.affiliations.length > 0;
const hasPublications = doctor.citations && doctor.citations.length > 0;
const hasAwards = doctor.awards && doctor.awards.length > 0;
const hasTimeline = doctor.timeline && doctor.timeline.length > 0;
const hasLineage = (doctor.mentors && doctor.mentors.length > 0) || (doctor.students && doctor.students.length > 0);
const hasMedia = hasImage || (doctor.galleryUrls && doctor.galleryUrls.length > 0) || (doctor.media && doctor.media.length > 0);

// Citation milestone
const citationMilestone = totalCitations >= 50000 ? '50K+' : totalCitations >= 10000 ? '10K+' : totalCitations >= 5000 ? '5K+' : totalCitations >= 1000 ? '1K+' : null;

// AI-Optimized Content availability flags (Phase 1)
const hasELI5Summary = doctor.eli5Summary && doctor.clinicalSummary;
const hasTechniqueBreakdowns = doctor.techniqueBreakdowns && doctor.techniqueBreakdowns.length > 0;
const hasVerifiedClaims = doctor.verifiedClaims && doctor.verifiedClaims.length > 0;
const hasEnhancedFAQs = doctor.faqs && doctor.faqs.length > 0;
const hasImpactTimeSeries = doctor.impactTimeSeries && doctor.impactTimeSeries.length > 0;
const hasConsensusTimeline = doctor.consensusTimeline && doctor.consensusTimeline.length > 0;
const hasMisconceptions = doctor.misconceptions && doctor.misconceptions.length > 0;
const hasClinicalScenarios = doctor.clinicalScenarios && doctor.clinicalScenarios.length > 0;

// AI-Optimized Content availability flags (Phase 2)
const hasMentorshipTree = doctor.mentorshipTree && (doctor.mentorshipTree.mentors.length > 0 || doctor.mentorshipTree.mentees.length > 0);
const hasCitationContexts = doctor.citationContexts && doctor.citationContexts.totalCitations > 0;
const hasFailureAnalyses = doctor.failureAnalyses && doctor.failureAnalyses.length > 0;
const hasMedicalLexicon = doctor.medicalLexicon && (doctor.medicalLexicon.primaryConditions.length > 0 || doctor.medicalLexicon.procedures.length > 0);
const hasFutureOutlook = doctor.futureOutlook && doctor.futureOutlook.fieldPredictions.length > 0;
const hasPatientJourneys = doctor.patientJourneys && doctor.patientJourneys.length > 0;
const hasComparativeMatrices = doctor.comparativeMatrices && doctor.comparativeMatrices.length > 0;
const hasDataExportConfig = doctor.dataExportConfig && doctor.dataExportConfig.availableFormats.length > 0;
const hasKeyInsights = doctor.keyInsights && doctor.keyInsights.topInsights.length > 0;
const hasInstitutionalEcosystem = doctor.institutionalEcosystem && (doctor.institutionalEcosystem.currentAffiliations.length > 0 || doctor.institutionalEcosystem.geographicInfluence.length > 0);

// AI-Optimized Content availability flags (Phase 3)
const hasOffLabelTracker = doctor.offLabelTracker && doctor.offLabelTracker.entries.length > 0;
const hasMedicalDiffs = doctor.medicalDiffs && doctor.medicalDiffs.diffs.length > 0;

const hasAnyAIContent = hasELI5Summary || hasTechniqueBreakdowns || hasVerifiedClaims || hasEnhancedFAQs || hasImpactTimeSeries || hasConsensusTimeline || hasMisconceptions || hasClinicalScenarios || hasMentorshipTree || hasCitationContexts || hasFailureAnalyses || hasMedicalLexicon || hasFutureOutlook || hasPatientJourneys || hasComparativeMatrices || hasKeyInsights || hasInstitutionalEcosystem || hasOffLabelTracker || hasMedicalDiffs;

// Top journals from citations
const topJournals = [...new Set(doctor.citations?.map(c => c.journal).filter(Boolean) || [])].slice(0, 5);

// Profile Completeness Score (for uniform display)
const completenessFactors = [
    hasImage,
    hasMeaningfulBio,
    hasAffiliations,
    hasPublications,
    hasAwards,
    hasTimeline,
    hasLineage,
    doctor.hIndex > 0,
    doctor.verifiedSurgeries > 0,
    doctor.livesSaved > 0,
    doctor.npiNumber || doctor.orcidId,
    doctor.knowsAbout && doctor.knowsAbout.length > 0,
];
const profileCompleteness = Math.round((completenessFactors.filter(Boolean).length / completenessFactors.length) * 100);
const completenessLabel = profileCompleteness >= 90 ? 'Comprehensive' : profileCompleteness >= 70 ? 'Well Documented' : profileCompleteness >= 50 ? 'Partially Complete' : 'Basic';

// Generate institution slug from hospital name
function slugifyInstitution(name: string): string {
    return name.toLowerCase()
        .replace(/[^a-z0-9\s-]/g, '')
        .replace(/\s+/g, '-')
        .slice(0, 50);
}
---

<Layout
    title={`${doctor.fullName} — MDRPedia`}
    description={aiSummary.slice(0, 160)}
    tier={doctor.tier}
    ogImage={`${Astro.site ?? "https://mdrpedia.com"}/og/${slug}.png`}
>
    <JsonLd
        fullName={doctor.fullName}
        specialty={doctor.specialty}
        subSpecialty={doctor.subSpecialty || undefined}
        biography={doctor.biography || undefined}
        portraitUrl={doctor.portraitUrl || undefined}
        geography={{
            country: doctor.geography.country,
            region: doctor.geography.region || undefined,
            city: doctor.geography.city || undefined,
        }}
        citations={doctor.citations}
        tier={doctor.tier}
        hIndex={doctor.hIndex}
        yearsActive={doctor.yearsActive}
        url={Astro.url.href}
        npiNumber={doctor.npiNumber || undefined}
        orcidId={doctor.orcidId || undefined}
        medicalSpecialty={doctor.medicalSpecialty}
        knowsAbout={doctor.knowsAbout}
        affiliations={doctor.affiliations?.map((a) => ({
            hospitalName: a.hospitalName,
            role: a.role || undefined,
            hospitalUrl: a.hospitalUrl || undefined,
        }))}
        aiSummary={aiSummary || undefined}
        dateOfBirth={doctor.dateOfBirth || undefined}
        dateOfDeath={doctor.dateOfDeath || undefined}
        mentors={doctor.mentors}
        students={doctor.students}
    />

    <!-- AI Content JSON-LD Schemas -->
    {hasAnyAIContent && (
        <AIContentSchema
            doctor={doctor}
            slug={slug}
            pageUrl={Astro.url.href}
        />
    )}

    <!-- Hidden AI Context for LLM crawlers -->
    <HiddenAIContext doctor={doctor} />

    <!-- Medical Knowledge Graph: Interconnected Doctor → Hospital → Technique → Citation -->
    <MedicalKnowledgeGraph
        slug={slug}
        fullName={doctor.fullName}
        specialty={doctor.specialty}
        subSpecialty={doctor.subSpecialty || undefined}
        biography={doctor.biography || undefined}
        aiSummary={aiSummary || undefined}
        portraitUrl={doctor.portraitUrl || undefined}
        geography={{
            country: doctor.geography.country,
            region: doctor.geography.region || undefined,
            city: doctor.geography.city || undefined,
        }}
        tier={doctor.tier}
        hIndex={doctor.hIndex}
        yearsActive={doctor.yearsActive}
        url={Astro.url.href}
        npiNumber={doctor.npiNumber || undefined}
        orcidId={doctor.orcidId || undefined}
        dateOfBirth={doctor.dateOfBirth || undefined}
        dateOfDeath={doctor.dateOfDeath || undefined}
        medicalSpecialty={doctor.medicalSpecialty}
        knowsAbout={doctor.knowsAbout}
        conditionsTreated={doctor.conditionsTreated}
        rareConditions={doctor.rareConditions}
        affiliations={doctor.affiliations?.map((a) => ({
            hospitalName: a.hospitalName,
            role: a.role || undefined,
            hospitalUrl: a.hospitalUrl || undefined,
        }))}
        techniques={doctor.techniquesInvented?.map((name, i) => ({
            name,
            yearInvented: doctor.timeline?.find(t =>
                t.title.toLowerCase().includes(name.toLowerCase()) ||
                t.description?.toLowerCase().includes(name.toLowerCase())
            )?.year,
            isGoldStandard: doctor.hasInvention,
        })) || []}
        citations={doctor.citations?.map((c) => ({
            doi: c.doi,
            pubmedId: c.pubmedId,
            title: c.title,
            journal: c.journal,
            year: c.year,
            abstract: c.abstract,
            citationCount: c.totalCitationCount,
            isOpenAccess: c.isOpenAccess,
        }))}
        awards={doctor.awards?.map((a) => ({
            name: a.name,
            year: a.year,
            issuingBody: a.issuingBody || undefined,
        }))}
        mentors={doctor.mentors}
        students={doctor.students}
        talks={doctor.talks}
    />

    <article class={`doctor-profile tier-${doctor.tier.toLowerCase()}`}>
        <!-- ═══════════════════ HERO SECTION ═══════════════════ -->
        <header class="hero" style={`background: ${heroGradient};`}>
            <div class="hero__container">
                <!-- Portrait Column -->
                <div class="hero__portrait-col">
                    <div class={`hero__frame hero__frame--${doctor.tier.toLowerCase()}`}>
                        {hasImage ? (
                            <img src={doctor.portraitUrl} alt={doctor.fullName} class="hero__image" loading="eager" />
                        ) : (
                            <div class="hero__initials">{initials}</div>
                        )}
                    </div>

                    {/* Quick verification badges */}
                    <div class="hero__badges">
                        {doctor.npiNumber && <span class="verify-badge" title="NPI Verified">✓ NPI</span>}
                        {doctor.orcidId && (
                            <a href={`https://orcid.org/${doctor.orcidId}`} target="_blank" rel="noopener" class="verify-badge">✓ ORCID</a>
                        )}
                    </div>
                </div>

                <!-- Info Column -->
                <div class="hero__info-col">
                    <div class="hero__tier-row">
                        <TierBadge tier={doctor.tier as any} />
                        {isHistorical && <span class="historical-tag">Historical Figure</span>}
                    </div>

                    <h1 class="hero__name">{doctor.fullName}</h1>

                    <p class="hero__specialty">
                        {doctor.specialty}
                        {doctor.subSpecialty && <span class="hero__subspecialty"> · {doctor.subSpecialty}</span>}
                    </p>

                    {location && location !== "Unknown" && (
                        <p class="hero__location">
                            <svg width="16" height="16" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                <path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"/><circle cx="12" cy="10" r="3"/>
                            </svg>
                            {location}
                        </p>
                    )}

                    <!-- Key Metrics Grid -->
                    <div class="hero__metrics">
                        {doctor.hIndex > 0 && (
                            <div class="metric">
                                <span class="metric__value js-counter" data-target={doctor.hIndex}>{doctor.hIndex}</span>
                                <span class="metric__label">H-Index</span>
                            </div>
                        )}
                        {totalCitations > 0 && (
                            <div class="metric">
                                <span class="metric__value js-counter" data-target={totalCitations}>{totalCitations.toLocaleString()}</span>
                                <span class="metric__label">Citations</span>
                            </div>
                        )}
                        {doctor.verifiedSurgeries > 0 && (
                            <div class="metric">
                                <span class="metric__value js-counter" data-target={doctor.verifiedSurgeries}>{doctor.verifiedSurgeries.toLocaleString()}</span>
                                <span class="metric__label">Surgeries</span>
                            </div>
                        )}
                        {doctor.livesSaved > 0 && (
                            <div class="metric">
                                <span 
                                    class="metric__value js-counter" 
                                    data-target={doctor.livesSaved}
                                    data-live-increment="true"
                                >
                                    {doctor.livesSaved.toLocaleString()}
                                </span>
                                <span class="metric__label">Lives Saved</span>
                            </div>
                        )}
                        {doctor.yearsActive > 0 && (
                            <div class="metric">
                                <span class="metric__value js-counter" data-target={doctor.yearsActive}>{doctor.yearsActive}</span>
                                <span class="metric__label">Years Active</span>
                            </div>
                        )}
                        {totalImpact > 0 && (
                            <div class="metric metric--impact">
                                <span
                                    class="metric__value js-counter"
                                    data-target={totalImpact}
                                    data-live-increment="true"
                                >
                                    {totalImpact.toLocaleString()}
                                </span>
                                <span class="metric__label">Total Impact</span>
                            </div>
                        )}
                    </div>

                    <!-- Action Buttons -->
                    <div class="hero__actions">
                        <ImpactVoteButton
                            client:visible
                            slug={slug}
                            profileId={profileId}
                            doctorName={doctor.fullName}
                        />
                        <ProfileEmbed
                            slug={slug}
                            fullName={doctor.fullName}
                            specialty={doctor.specialty}
                            tier={doctor.tier}
                            hasImage={!!hasImage}
                            totalImpact={totalImpact}
                            hIndex={doctor.hIndex}
                            livesSaved={doctor.livesSaved}
                        />
                        <ShareProfileModal
                            client:idle
                            slug={slug}
                            fullName={doctor.fullName}
                            title={`MDRPedia: ${doctor.fullName}`}
                        />
                        {doctor.tier === "UNRANKED" && (
                            <a href="/doctor/claim" class="btn btn--outline">Claim Profile</a>
                        )}
                    </div>
                </div>
            </div>
        </header>

        <!-- ═══════════════════ AWARDS RIBBON ═══════════════════ -->
        {hasAwards && (
            <section class="awards-ribbon-section">
                <div class="container">
                    <AwardsRibbon awards={doctor.awards!.map(a => ({
                        name: a.name,
                        year: a.year,
                        issuingBody: a.issuingBody ?? undefined,
                        sourceUrl: a.sourceUrl ?? undefined,
                    }))} />
                </div>
            </section>
        )}

        <!-- ═══════════════════ MAIN CONTENT ═══════════════════ -->
        <div class="content-wrapper">
            <div class="container">
                <div class="content-grid">
                    <!-- Main Column -->
                    <main class="main-col">

                        <!-- Overview / Summary -->
                        <section class="card card--overview">
                            <h2 class="card__title">
                                <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                    <circle cx="12" cy="12" r="10"/><path d="M12 16v-4M12 8h.01"/>
                                </svg>
                                Overview
                            </h2>
                            <p class="card__summary">{aiSummary}</p>
                        </section>

                        <!-- Biography -->
                        {hasMeaningfulBio && (
                            <section class="card">
                                <h2 class="card__title">Biography</h2>
                                <div class="prose" set:html={doctor.biography} />
                            </section>
                        )}

                        <!-- ═══════════════════ AI-OPTIMIZED CONTENT SECTIONS ═══════════════════ -->

                        <!-- ELI5 vs Clinical Summary -->
                        {hasELI5Summary && (
                            <ELI5Summary
                                eli5Summary={doctor.eli5Summary!}
                                clinicalSummary={doctor.clinicalSummary!}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Verified Claims Section -->
                        {hasVerifiedClaims && (
                            <VerifiedClaims
                                claims={doctor.verifiedClaims!}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Technique Breakdowns -->
                        {hasTechniqueBreakdowns && doctor.techniqueBreakdowns!.map(technique => (
                            <TechniqueBreakdown
                                technique={technique}
                                tier={doctor.tier}
                            />
                        ))}

                        <!-- Enhanced FAQs -->
                        {hasEnhancedFAQs && (
                            <EnhancedFAQ
                                faqs={doctor.faqs!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Impact Metrics Over Time -->
                        {hasImpactTimeSeries && (
                            <ImpactMetricsTable
                                data={doctor.impactTimeSeries!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Controversies / Consensus Timeline -->
                        {hasConsensusTimeline && doctor.consensusTimeline!.map(timeline => (
                            <ControversiesTimeline
                                timeline={timeline}
                                tier={doctor.tier}
                            />
                        ))}

                        <!-- Common Misconceptions -->
                        {hasMisconceptions && (
                            <MisconceptionsTable
                                misconceptions={doctor.misconceptions!}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Clinical Scenarios -->
                        {hasClinicalScenarios && doctor.clinicalScenarios!.map(scenario => (
                            <ClinicalScenarios
                                scenario={scenario}
                                tier={doctor.tier}
                            />
                        ))}

                        <!-- ═══════════════════ AI-OPTIMIZED CONTENT (PHASE 2) ═══════════════════ -->

                        <!-- Key Insights Summary -->
                        {hasKeyInsights && (
                            <KeyInsights
                                insights={doctor.keyInsights!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Medical Mentorship Tree / Genealogy -->
                        {hasMentorshipTree && (
                            <MentorshipTree
                                tree={doctor.mentorshipTree!}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Institutional & Geographic Ecosystem -->
                        {hasInstitutionalEcosystem && (
                            <InstitutionalEcosystem
                                ecosystem={doctor.institutionalEcosystem!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Citation Context Analysis -->
                        {hasCitationContexts && (
                            <CitationContexts
                                summary={doctor.citationContexts!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Medical Lexicon Tags -->
                        {hasMedicalLexicon && (
                            <MedicalLexiconTags
                                lexicon={doctor.medicalLexicon!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Patient Journey Maps -->
                        {hasPatientJourneys && doctor.patientJourneys!.map(journey => (
                            <PatientJourneyMap
                                journey={journey}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        ))}

                        <!-- Future Outlook -->
                        {hasFutureOutlook && (
                            <FutureOutlook
                                outlook={doctor.futureOutlook!}
                                doctorName={doctor.fullName}
                                specialty={doctor.specialty}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Comparative Matrices -->
                        {hasComparativeMatrices && doctor.comparativeMatrices!.map(matrix => (
                            <ComparativeMatrix
                                matrix={matrix}
                                tier={doctor.tier}
                            />
                        ))}

                        <!-- Failure Analysis / Lessons Learned -->
                        {hasFailureAnalyses && (
                            <FailureAnalysis
                                analyses={doctor.failureAnalyses!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Data Export Panel -->
                        {hasDataExportConfig && (
                            <DataExportPanel
                                config={doctor.dataExportConfig!}
                                doctorName={doctor.fullName}
                                doctorSlug={slug}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- ═══════════════════ AI-OPTIMIZED CONTENT (PHASE 3) ═══════════════════ -->

                        <!-- Off-Label vs FDA-Approved Usage Tracker -->
                        {hasOffLabelTracker && (
                            <OffLabelTracker
                                tracker={doctor.offLabelTracker!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- Medical Guideline Diffs (How Guidelines Changed) -->
                        {hasMedicalDiffs && (
                            <MedicalDiffs
                                data={doctor.medicalDiffs!}
                                doctorName={doctor.fullName}
                                tier={doctor.tier}
                            />
                        )}

                        <!-- ═══════════════════ END AI-OPTIMIZED CONTENT ═══════════════════ -->

                        <!-- Affiliations & Institutions -->
                        {hasAffiliations && (
                            <section class="card">
                                <h2 class="card__title">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path d="M19 21V5a2 2 0 00-2-2H7a2 2 0 00-2 2v16m14 0h2m-2 0h-5m-9 0H3m2 0h5M9 7h1m-1 4h1m4-4h1m-1 4h1m-5 10v-5a1 1 0 011-1h2a1 1 0 011 1v5m-4 0h4"/>
                                    </svg>
                                    Affiliations & Institutions
                                </h2>
                                <div class="affiliations-grid">
                                    {doctor.affiliations!.map((aff) => {
                                        const logoUrl = getInstitutionLogo(aff.hospitalName);
                                        const initials = getInstitutionInitials(aff.hospitalName);
                                        const bgColor = getInstitutionColor(aff.hospitalName);
                                        return (
                                            <a
                                                href={`/institutions/${slugifyInstitution(aff.hospitalName)}`}
                                                class="affiliation-card"
                                            >
                                                <div class="affiliation-card__logo">
                                                    {logoUrl ? (
                                                        <img
                                                            src={logoUrl}
                                                            alt={aff.hospitalName}
                                                            loading="lazy"
                                                            onerror="this.style.display='none';this.nextElementSibling.style.display='flex';"
                                                        />
                                                        <div class="affiliation-card__initials" style={`background: ${bgColor}; display: none;`}>
                                                            {initials}
                                                        </div>
                                                    ) : (
                                                        <div class="affiliation-card__initials" style={`background: ${bgColor};`}>
                                                            {initials}
                                                        </div>
                                                    )}
                                                </div>
                                                <div class="affiliation-card__info">
                                                    <h4 class="affiliation-card__name">{aff.hospitalName}</h4>
                                                    {aff.role && <p class="affiliation-card__role">{aff.role}</p>}
                                                </div>
                                                <svg class="affiliation-card__arrow" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                    <path d="M5 12h14M12 5l7 7-7 7"/>
                                                </svg>
                                            </a>
                                        );
                                    })}
                                </div>
                            </section>
                        )}

                        <!-- Research Impact -->
                        {hasPublications && (
                            <section class="card">
                                <h2 class="card__title">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path d="M12 6.253v13m0-13C10.832 5.477 9.246 5 7.5 5S4.168 5.477 3 6.253v13C4.168 18.477 5.754 18 7.5 18s3.332.477 4.5 1.253m0-13C13.168 5.477 14.754 5 16.5 5c1.747 0 3.332.477 4.5 1.253v13C19.832 18.477 18.247 18 16.5 18c-1.746 0-3.332.477-4.5 1.253"/>
                                    </svg>
                                    Research Impact
                                </h2>

                                <!-- Research Stats Bar -->
                                <div class="research-stats">
                                    <div class="research-stat">
                                        <span class="research-stat__value">{doctor.citations!.length}</span>
                                        <span class="research-stat__label">Publications</span>
                                    </div>
                                    <div class="research-stat">
                                        <span class="research-stat__value">{totalCitations.toLocaleString()}</span>
                                        <span class="research-stat__label">Total Citations</span>
                                    </div>
                                    {citationMilestone && (
                                        <div class="research-stat research-stat--highlight">
                                            <span class="research-stat__value">{citationMilestone}</span>
                                            <span class="research-stat__label">Citation Milestone</span>
                                        </div>
                                    )}
                                </div>

                                {/* Top Journals */}
                                {topJournals.length > 0 && (
                                    <div class="journals-section">
                                        <h4 class="journals-title">Published In</h4>
                                        <div class="journals-list">
                                            {topJournals.map(journal => (
                                                <span class="journal-tag">{journal}</span>
                                            ))}
                                        </div>
                                    </div>
                                )}

                                <!-- Key Publications -->
                                <div class="publications-list">
                                    <h4 class="publications-title">Key Publications</h4>
                                    {doctor.citations!.slice(0, 5).map((citation) => (
                                        <article class="publication">
                                            <h5 class="publication__title">
                                                {citation.doi ? (
                                                    <a
                                                        href={`https://doi.org/${citation.doi}`}
                                                        target="_blank"
                                                        rel="noopener noreferrer"
                                                    >
                                                        {citation.title}
                                                    </a>
                                                ) : (
                                                    <span>{citation.title}</span>
                                                )}
                                            </h5>
                                            <div class="publication__meta">
                                                {citation.journal && <span class="publication__journal">{citation.journal}</span>}
                                                {citation.year && <span class="publication__year">{citation.year}</span>}
                                                {((citation.citationCount ?? citation.totalCitationCount ?? 0) > 0) && (
                                                    <span class="publication__citations">
                                                        {(citation.citationCount ?? citation.totalCitationCount ?? 0).toLocaleString()} citations
                                                    </span>
                                                )}
                                            </div>
                                            <div class="publication__links">
                                                {citation.doi && (
                                                    <a href={`https://doi.org/${citation.doi}`} target="_blank" rel="noopener" class="pub-link" title="DOI">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <path d="M18 13v6a2 2 0 01-2 2H5a2 2 0 01-2-2V8a2 2 0 012-2h6"/>
                                                            <polyline points="15 3 21 3 21 9"/>
                                                            <line x1="10" y1="14" x2="21" y2="3"/>
                                                        </svg>
                                                        DOI
                                                    </a>
                                                )}
                                                {citation.pubmedId && (
                                                    <a href={`https://pubmed.ncbi.nlm.nih.gov/${citation.pubmedId}`} target="_blank" rel="noopener" class="pub-link pub-link--pubmed" title="PubMed">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <path d="M4 19.5A2.5 2.5 0 016.5 17H20"/>
                                                            <path d="M6.5 2H20v20H6.5A2.5 2.5 0 014 19.5v-15A2.5 2.5 0 016.5 2z"/>
                                                        </svg>
                                                        PubMed
                                                    </a>
                                                )}
                                                {citation.isOpenAccess && citation.openAccessUrl && (
                                                    <a href={citation.openAccessUrl} target="_blank" rel="noopener" class="pub-link pub-link--oa" title="Open Access">
                                                        <svg width="14" height="14" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"/>
                                                            <path d="M7 11V7a5 5 0 0110 0v4"/>
                                                        </svg>
                                                        Free PDF
                                                    </a>
                                                )}
                                            </div>
                                        </article>
                                    ))}

                                    {doctor.citations!.length > 5 && (
                                        <button class="btn btn--text show-more-btn" data-expand="publications">
                                            View all {doctor.citations!.length} publications
                                        </button>
                                    )}
                                </div>
                            </section>
                        )}

                        <!-- Expertise & Specializations -->
                        {((doctor.knowsAbout && doctor.knowsAbout.length > 0) ||
                          (doctor.rareConditions && doctor.rareConditions.length > 0) ||
                          (doctor.conditionsTreated && doctor.conditionsTreated.length > 0) ||
                          (doctor.techniquesInvented && doctor.techniquesInvented.length > 0) ||
                          (doctor.medicalSpecialty && doctor.medicalSpecialty.length > 0)) && (
                            <section class="card">
                                <h2 class="card__title">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path d="M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"/>
                                    </svg>
                                    Areas of Expertise
                                </h2>
                                <div class="expertise-container">
                                    {doctor.techniquesInvented && doctor.techniquesInvented.length > 0 && (
                                        <div class="expertise-group">
                                            <h4 class="expertise-group__title">Pioneering Techniques</h4>
                                            <div class="tags">
                                                {doctor.techniquesInvented.map(tech => (
                                                    <span class="tag tag--technique">{tech}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {doctor.rareConditions && doctor.rareConditions.length > 0 && (
                                        <div class="expertise-group">
                                            <h4 class="expertise-group__title">Rare Conditions Treated</h4>
                                            <div class="tags">
                                                {doctor.rareConditions.map(condition => (
                                                    <span class="tag tag--rare">{condition}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {doctor.medicalSpecialty && doctor.medicalSpecialty.length > 0 && (
                                        <div class="expertise-group">
                                            <h4 class="expertise-group__title">Medical Specialties</h4>
                                            <div class="tags">
                                                {doctor.medicalSpecialty.map(spec => (
                                                    <span class="tag tag--specialty">{spec}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {doctor.conditionsTreated && doctor.conditionsTreated.length > 0 && (
                                        <div class="expertise-group">
                                            <h4 class="expertise-group__title">Conditions & Diseases Treated</h4>
                                            <div class="tags">
                                                {doctor.conditionsTreated.map(condition => (
                                                    <span class="tag tag--condition">{condition}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                    {doctor.knowsAbout && doctor.knowsAbout.length > 0 && (
                                        <div class="expertise-group">
                                            <h4 class="expertise-group__title">Clinical Knowledge & Procedures</h4>
                                            <div class="tags">
                                                {doctor.knowsAbout.map(topic => (
                                                    <span class="tag">{topic}</span>
                                                ))}
                                            </div>
                                        </div>
                                    )}
                                </div>
                            </section>
                        )}

                        <!-- Talks & Lectures -->
                        {doctor.talks && doctor.talks.length > 0 && (
                            <section class="card">
                                <h2 class="card__title">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <path d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-4.03 8-9 8a9.863 9.863 0 01-4.255-.949L3 20l1.395-3.72C3.512 15.042 3 13.574 3 12c0-4.418 4.03-8 9-8s9 3.582 9 8z"/>
                                    </svg>
                                    Talks & Lectures
                                </h2>
                                <div class="talks-list">
                                    {doctor.talks.map((talk) => (
                                        <article class="talk-card">
                                            <div class="talk-card__year">{talk.year}</div>
                                            <div class="talk-card__content">
                                                <h4 class="talk-card__title">{talk.title}</h4>
                                                <p class="talk-card__event">{talk.event}</p>
                                            </div>
                                        </article>
                                    ))}
                                </div>
                            </section>
                        )}

                        <!-- Medical Lineage -->
                        {hasLineage && (
                            <section class="card">
                                <MedicalLineageGraph
                                    client:visible
                                    doctorName={doctor.fullName}
                                    mentors={doctor.mentors || []}
                                    students={doctor.students || []}
                                />
                            </section>
                        )}

                        <!-- Career Timeline -->
                        {hasTimeline && (
                            <section class="card">
                                <LegacyTimeline
                                    entries={doctor.timeline!}
                                    doctorName={doctor.fullName}
                                />
                            </section>
                        )}

                        <!-- Media Gallery -->
                        {hasMedia && (
                            <section class="card">
                                <h2 class="card__title">
                                    <svg width="20" height="20" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24">
                                        <rect x="3" y="3" width="18" height="18" rx="2" ry="2"/><circle cx="8.5" cy="8.5" r="1.5"/><polyline points="21 15 16 10 5 21"/>
                                    </svg>
                                    Media Archive
                                </h2>
                                <MediaVault
                                    portraitUrl={doctor.portraitUrl || ''}
                                    fullName={doctor.fullName}
                                    galleryUrls={doctor.galleryUrls || []}
                                    tier={doctor.tier}
                                    media={(doctor.media || []).map(m => ({
                                        type: m.type,
                                        url: m.url,
                                        title: m.title ?? undefined,
                                        description: m.description ?? undefined,
                                        source: m.source ?? undefined,
                                        video_id: m.video_id ?? undefined,
                                        thumbnail: m.thumbnail ?? undefined,
                                        is_featured: m.is_featured,
                                    }))}
                                />
                            </section>
                        )}

                        <!-- Similar Doctors -->
                        <section class="card">
                            <SimilarDoctors
                                currentSlug={slug}
                                specialty={doctor.specialty}
                                country={doctor.geography.country}
                                region={doctor.geography.region}
                                tier={doctor.tier}
                            />
                        </section>
                    </main>

                    <!-- Sidebar -->
                    <aside class="sidebar-col">
                        <div class="sidebar-sticky">
                            <!-- Profile Completeness -->
                            <div class="sidebar-card completeness-card">
                                <div class="completeness-header">
                                    <h3 class="sidebar-card__title">Profile Status</h3>
                                    <span class={`completeness-badge completeness-badge--${profileCompleteness >= 90 ? 'high' : profileCompleteness >= 50 ? 'medium' : 'low'}`}>
                                        {completenessLabel}
                                    </span>
                                </div>
                                <div class="completeness-bar">
                                    <div class="completeness-bar__fill" style={`width: ${profileCompleteness}%`}></div>
                                </div>
                                <p class="completeness-text">{profileCompleteness}% complete</p>
                            </div>

                            <!-- Quick Facts Card -->
                            <div class="sidebar-card facts-card">
                                <h3 class="sidebar-card__title">Quick Facts</h3>
                                <dl class="facts-list">
                                    {doctor.dateOfBirth && (
                                        <div class="fact-row">
                                            <dt>Born</dt>
                                            <dd>{new Date(doctor.dateOfBirth).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</dd>
                                        </div>
                                    )}
                                    {isHistorical && doctor.dateOfDeath && (
                                        <div class="fact-row">
                                            <dt>Died</dt>
                                            <dd>{new Date(doctor.dateOfDeath).toLocaleDateString('en-US', { year: 'numeric', month: 'long', day: 'numeric' })}</dd>
                                        </div>
                                    )}
                                    <div class="fact-row">
                                        <dt>Nationality</dt>
                                        <dd>{doctor.geography.country}</dd>
                                    </div>
                                    <div class="fact-row">
                                        <dt>Specialty</dt>
                                        <dd>{doctor.specialty}</dd>
                                    </div>
                                    {doctor.hIndex > 0 && (
                                        <div class="fact-row">
                                            <dt>H-Index</dt>
                                            <dd><strong>{doctor.hIndex}</strong></dd>
                                        </div>
                                    )}
                                    {doctor.yearsActive > 0 && (
                                        <div class="fact-row">
                                            <dt>Years Active</dt>
                                            <dd>{doctor.yearsActive}</dd>
                                        </div>
                                    )}
                                </dl>
                            </div>

                            <!-- Credentials Card -->
                            {(doctor.orcidId || doctor.npiNumber) && (
                                <div class="sidebar-card credentials-card">
                                    <h3 class="sidebar-card__title">Verified Credentials</h3>
                                    {doctor.orcidId && (
                                        <a href={`https://orcid.org/${doctor.orcidId}`} target="_blank" rel="noopener" class="credential-link">
                                            <img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" alt="ORCID" width="16" height="16" />
                                            <span>{doctor.orcidId}</span>
                                        </a>
                                    )}
                                    {doctor.npiNumber && (
                                        <div class="credential-link">
                                            <span class="npi-icon">NPI</span>
                                            <span>{doctor.npiNumber}</span>
                                        </div>
                                    )}
                                </div>
                            )}

                            <!-- Primary Institution Card -->
                            {hasAffiliations && (() => {
                                const primaryAff = doctor.affiliations![0];
                                const primaryLogo = getInstitutionLogo(primaryAff.hospitalName);
                                const primaryInitials = getInstitutionInitials(primaryAff.hospitalName);
                                const primaryBgColor = getInstitutionColor(primaryAff.hospitalName);
                                return (
                                    <div class="sidebar-card institution-card">
                                        <h3 class="sidebar-card__title">Primary Institution</h3>
                                        <a href={`/institutions/${slugifyInstitution(primaryAff.hospitalName)}`} class="institution-link">
                                            <div class="institution-logo">
                                                {primaryLogo ? (
                                                    <img
                                                        src={primaryLogo}
                                                        alt={primaryAff.hospitalName}
                                                        loading="lazy"
                                                        onerror="this.style.display='none';this.nextElementSibling.style.display='flex';"
                                                    />
                                                ) : null}
                                                <div
                                                    class="institution-initials"
                                                    style={`background: ${primaryBgColor}; ${primaryLogo ? 'display: none;' : ''}`}
                                                >
                                                    {primaryInitials}
                                                </div>
                                            </div>
                                            <div class="institution-info">
                                                <span class="institution-name">{primaryAff.hospitalName}</span>
                                                {primaryAff.role && (
                                                    <span class="institution-role">{primaryAff.role}</span>
                                                )}
                                            </div>
                                        </a>
                                        {doctor.affiliations!.length > 1 && (
                                            <p class="institution-more">
                                                +{doctor.affiliations!.length - 1} other affiliation{doctor.affiliations!.length > 2 ? 's' : ''}
                                            </p>
                                        )}
                                    </div>
                                );
                            })()}

                            <!-- Consultation Card (for living doctors) -->
                            {!isHistorical && (doctor.consultationPrice || doctor.teleConsultationPrice) && (
                                <div class="sidebar-card consultation-card">
                                    <h3 class="sidebar-card__title">Book Consultation</h3>
                                    {doctor.consultationPrice && (
                                        <div class="price-row">
                                            <span>In-Person</span>
                                            <strong>{doctor.consultationPrice}</strong>
                                        </div>
                                    )}
                                    {doctor.teleConsultationPrice && (
                                        <div class="price-row">
                                            <span>Video Call</span>
                                            <strong>{doctor.teleConsultationPrice}</strong>
                                        </div>
                                    )}
                                    <a href="#" class="btn btn--primary btn--full">Book Appointment</a>
                                </div>
                            )}

                            <!-- Improve This Profile -->
                            <div class="sidebar-card suggest-card">
                                <div class="suggest-icon">
                                    <svg width="32" height="32" fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24">
                                        <path d="M9.663 17h4.673M12 3v1m6.364 1.636l-.707.707M21 12h-1M4 12H3m3.343-5.657l-.707-.707m2.828 9.9a5 5 0 117.072 0l-.548.547A3.374 3.374 0 0014 18.469V19a2 2 0 11-4 0v-.531c0-.895-.356-1.754-.988-2.386l-.548-.547z"/>
                                    </svg>
                                </div>
                                <h4 class="suggest-title">Help Improve This Profile</h4>
                                <p class="suggest-text">Know additional details about {doctor.fullName.split(' ')[0]}? Share information to help make this profile more comprehensive.</p>
                                <div class="suggest-options">
                                    <a href={`/suggest-edit?profile=${slug}&type=citation`} class="suggest-option">
                                        <span class="suggest-option__icon">📚</span>
                                        <span>Add Citation</span>
                                    </a>
                                    <a href={`/suggest-edit?profile=${slug}&type=award`} class="suggest-option">
                                        <span class="suggest-option__icon">🏆</span>
                                        <span>Add Award</span>
                                    </a>
                                    <a href={`/suggest-edit?profile=${slug}&type=affiliation`} class="suggest-option">
                                        <span class="suggest-option__icon">🏥</span>
                                        <span>Add Affiliation</span>
                                    </a>
                                    <a href={`/suggest-edit?profile=${slug}&type=general`} class="suggest-option">
                                        <span class="suggest-option__icon">✏️</span>
                                        <span>Other Info</span>
                                    </a>
                                </div>
                                <p class="suggest-note">All suggestions are reviewed before publishing</p>
                            </div>
                        </div>
                    </aside>
                </div>
            </div>
        </div>
    </article>
</Layout>

<style>
    /* ═══════════════════════════════════════════════════════════════════════════
       DOCTOR PROFILE — PREMIUM MEDICAL DESIGN SYSTEM
       ═══════════════════════════════════════════════════════════════════════════ */

    /* Base Variables */
    .doctor-profile {
        --card-bg: rgba(17, 17, 27, 0.95);
        --card-border: rgba(255, 255, 255, 0.06);
        --card-hover-border: rgba(255, 255, 255, 0.12);
        --card-radius: 20px;
        --metric-bg: rgba(255, 255, 255, 0.03);
        --section-gap: 1.5rem;
        position: relative;
    }

    /* Background noise texture */
    .doctor-profile::before {
        content: '';
        position: fixed;
        inset: 0;
        background: radial-gradient(ellipse 80% 50% at 50% -20%, rgba(120, 119, 198, 0.15), transparent);
        pointer-events: none;
        z-index: -1;
    }

    /* Tier-specific accent colors and comprehensive styling */

    /* ═══════════════════════════════════════════════════════════════════════════
       TITAN TIER - Gold/Amber Theme
       ═══════════════════════════════════════════════════════════════════════════ */
    .tier-titan {
        --accent: #fbbf24;
        --accent-glow: rgba(251, 191, 36, 0.25);
        --accent-rgb: 251, 191, 36;
        --tier-text-primary: #fefce8;
        --tier-text-secondary: #fef3c7;
        --tier-text-muted: #fcd34d;
        --tier-border: rgba(251, 191, 36, 0.3);
        --tier-surface: rgba(30, 20, 10, 0.95);
        --tier-surface-hover: rgba(45, 30, 15, 0.95);
    }

    .tier-titan .hero {
        background: linear-gradient(135deg, rgba(30, 20, 10, 0.98) 0%, rgba(15, 10, 5, 0.98) 100%) !important;
    }

    .tier-titan .hero::before {
        background: radial-gradient(ellipse 60% 40% at 50% 0%, rgba(251, 191, 36, 0.15) 0%, transparent 70%) !important;
    }

    .tier-titan .hero__name {
        background: linear-gradient(135deg, #fef3c7 0%, #fbbf24 50%, #f59e0b 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
    }

    .tier-titan .hero__specialty,
    .tier-titan .hero__subspecialty {
        color: var(--tier-text-secondary) !important;
    }

    .tier-titan .hero__location {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .metric {
        background: rgba(251, 191, 36, 0.08) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-titan .metric__value {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .metric__label {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .card {
        background: var(--tier-surface) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-titan .card:hover {
        background: var(--tier-surface-hover) !important;
        border-color: rgba(251, 191, 36, 0.5) !important;
    }

    .tier-titan .card__title {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .card__title svg {
        color: #fbbf24 !important;
    }

    .tier-titan .card__summary,
    .tier-titan .bio-text,
    .tier-titan .prose,
    .tier-titan .prose p {
        color: var(--tier-text-secondary) !important;
    }

    .tier-titan .sidebar-card {
        background: var(--tier-surface) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-titan .sidebar-card__title {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .fact-row dt {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .fact-row dd {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .publication__title,
    .tier-titan .pub-title {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .publication__meta,
    .tier-titan .publication__journal,
    .tier-titan .publication__year,
    .tier-titan .pub-authors,
    .tier-titan .pub-journal {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .publication__citations {
        color: #fbbf24 !important;
    }

    .tier-titan .pub-link {
        color: #fbbf24 !important;
    }

    .tier-titan .affiliation-card {
        background: rgba(251, 191, 36, 0.05) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-titan .affiliation-card__name {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .affiliation-card__role {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .research-stat__value {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .research-stat__label {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .tag {
        background: rgba(251, 191, 36, 0.15) !important;
        color: #fbbf24 !important;
        border-color: var(--tier-border) !important;
    }

    .tier-titan .award-name {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .award-year,
    .tier-titan .award-issuer {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan .suggest-title {
        color: var(--tier-text-primary) !important;
    }

    .tier-titan .suggest-text {
        color: var(--tier-text-muted) !important;
    }

    .tier-titan a:not(.btn):not(.nav-link) {
        color: #fbbf24 !important;
    }

    .tier-titan h2, .tier-titan h3, .tier-titan h4 {
        color: var(--tier-text-primary) !important;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       ELITE TIER - Cyan/Blue Theme
       ═══════════════════════════════════════════════════════════════════════════ */
    .tier-elite {
        --accent: #38bdf8;
        --accent-glow: rgba(56, 189, 248, 0.2);
        --accent-rgb: 56, 189, 248;
        --tier-text-primary: #f0f9ff;
        --tier-text-secondary: #bae6fd;
        --tier-text-muted: #7dd3fc;
        --tier-border: rgba(56, 189, 248, 0.3);
        --tier-surface: rgba(10, 20, 35, 0.95);
        --tier-surface-hover: rgba(15, 30, 50, 0.95);
    }

    .tier-elite .hero {
        background: linear-gradient(135deg, rgba(10, 20, 35, 0.98) 0%, rgba(5, 15, 25, 0.98) 100%) !important;
    }

    .tier-elite .hero::before {
        background: radial-gradient(ellipse 60% 40% at 50% 0%, rgba(56, 189, 248, 0.12) 0%, transparent 70%) !important;
    }

    .tier-elite .hero__name {
        background: linear-gradient(135deg, #f0f9ff 0%, #38bdf8 50%, #0ea5e9 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
    }

    .tier-elite .hero__specialty,
    .tier-elite .hero__subspecialty {
        color: var(--tier-text-secondary) !important;
    }

    .tier-elite .hero__location {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .metric {
        background: rgba(56, 189, 248, 0.08) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-elite .metric__value {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .metric__label {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .card {
        background: var(--tier-surface) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-elite .card:hover {
        background: var(--tier-surface-hover) !important;
        border-color: rgba(56, 189, 248, 0.5) !important;
    }

    .tier-elite .card__title {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .card__title svg {
        color: #38bdf8 !important;
    }

    .tier-elite .card__summary,
    .tier-elite .bio-text,
    .tier-elite .prose,
    .tier-elite .prose p {
        color: var(--tier-text-secondary) !important;
    }

    .tier-elite .sidebar-card {
        background: var(--tier-surface) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-elite .sidebar-card__title {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .fact-row dt {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .fact-row dd {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .publication__title,
    .tier-elite .pub-title {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .publication__meta,
    .tier-elite .publication__journal,
    .tier-elite .publication__year,
    .tier-elite .pub-authors,
    .tier-elite .pub-journal {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .publication__citations {
        color: #38bdf8 !important;
    }

    .tier-elite .pub-link {
        color: #38bdf8 !important;
    }

    .tier-elite .affiliation-card {
        background: rgba(56, 189, 248, 0.05) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-elite .affiliation-card__name {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .affiliation-card__role {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .research-stat__value {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .research-stat__label {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .tag {
        background: rgba(56, 189, 248, 0.15) !important;
        color: #38bdf8 !important;
        border-color: var(--tier-border) !important;
    }

    .tier-elite .award-name {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .award-year,
    .tier-elite .award-issuer {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite .suggest-title {
        color: var(--tier-text-primary) !important;
    }

    .tier-elite .suggest-text {
        color: var(--tier-text-muted) !important;
    }

    .tier-elite a:not(.btn):not(.nav-link) {
        color: #38bdf8 !important;
    }

    .tier-elite h2, .tier-elite h3, .tier-elite h4 {
        color: var(--tier-text-primary) !important;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       MASTER TIER - Green/Emerald Theme
       ═══════════════════════════════════════════════════════════════════════════ */
    .tier-master {
        --accent: #4ade80;
        --accent-glow: rgba(74, 222, 128, 0.2);
        --accent-rgb: 74, 222, 128;
        --tier-text-primary: #f0fdf4;
        --tier-text-secondary: #bbf7d0;
        --tier-text-muted: #86efac;
        --tier-border: rgba(74, 222, 128, 0.3);
        --tier-surface: rgba(10, 30, 20, 0.95);
        --tier-surface-hover: rgba(15, 45, 30, 0.95);
    }

    .tier-master .hero {
        background: linear-gradient(135deg, rgba(10, 30, 20, 0.98) 0%, rgba(5, 20, 12, 0.98) 100%) !important;
    }

    .tier-master .hero::before {
        background: radial-gradient(ellipse 60% 40% at 50% 0%, rgba(74, 222, 128, 0.12) 0%, transparent 70%) !important;
    }

    .tier-master .hero__name {
        background: linear-gradient(135deg, #f0fdf4 0%, #4ade80 50%, #22c55e 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
    }

    .tier-master .hero__specialty,
    .tier-master .hero__subspecialty {
        color: var(--tier-text-secondary) !important;
    }

    .tier-master .hero__location {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .metric {
        background: rgba(74, 222, 128, 0.08) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-master .metric__value {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .metric__label {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .card {
        background: var(--tier-surface) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-master .card:hover {
        background: var(--tier-surface-hover) !important;
        border-color: rgba(74, 222, 128, 0.5) !important;
    }

    .tier-master .card__title {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .card__title svg {
        color: #4ade80 !important;
    }

    .tier-master .card__summary,
    .tier-master .bio-text,
    .tier-master .prose,
    .tier-master .prose p {
        color: var(--tier-text-secondary) !important;
    }

    .tier-master .sidebar-card {
        background: var(--tier-surface) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-master .sidebar-card__title {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .fact-row dt {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .fact-row dd {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .publication__title,
    .tier-master .pub-title {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .publication__meta,
    .tier-master .publication__journal,
    .tier-master .publication__year,
    .tier-master .pub-authors,
    .tier-master .pub-journal {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .publication__citations {
        color: #4ade80 !important;
    }

    .tier-master .pub-link {
        color: #4ade80 !important;
    }

    .tier-master .affiliation-card {
        background: rgba(74, 222, 128, 0.05) !important;
        border-color: var(--tier-border) !important;
    }

    .tier-master .affiliation-card__name {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .affiliation-card__role {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .research-stat__value {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .research-stat__label {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .tag {
        background: rgba(74, 222, 128, 0.15) !important;
        color: #4ade80 !important;
        border-color: var(--tier-border) !important;
    }

    .tier-master .award-name {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .award-year,
    .tier-master .award-issuer {
        color: var(--tier-text-muted) !important;
    }

    .tier-master .suggest-title {
        color: var(--tier-text-primary) !important;
    }

    .tier-master .suggest-text {
        color: var(--tier-text-muted) !important;
    }

    .tier-master a:not(.btn):not(.nav-link) {
        color: #4ade80 !important;
    }

    .tier-master h2, .tier-master h3, .tier-master h4 {
        color: var(--tier-text-primary) !important;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       UNRANKED TIER - Slate/Blue Theme
       ═══════════════════════════════════════════════════════════════════════════ */
    .tier-unranked {
        --accent: #60a5fa;
        --accent-glow: rgba(96, 165, 250, 0.15);
        --accent-rgb: 96, 165, 250;
        --card-bg: #0c1222;
        --unranked-text-primary: #f8fafc;
        --unranked-text-secondary: #cbd5e1;
        --unranked-text-muted: #94a3b8;
        --unranked-border: rgba(148, 163, 184, 0.2);
        --unranked-surface: #0f172a;
        --unranked-surface-hover: #1e293b;
    }

    /* ═══════════════════════════════════════════════════════════════════════════
       UNRANKED PROFILE - COMPLETE REDESIGN
       Professional slate/blue theme with high contrast and distinctive identity
       ═══════════════════════════════════════════════════════════════════════════ */

    /* Hero Section - Dark slate with subtle blue accents */
    .tier-unranked .hero {
        background: linear-gradient(180deg, #0f172a 0%, #020617 100%) !important;
        border-bottom: 1px solid var(--unranked-border) !important;
    }

    .tier-unranked .hero::before {
        background: radial-gradient(ellipse 60% 40% at 50% 0%, rgba(96, 165, 250, 0.08) 0%, transparent 70%) !important;
    }

    .tier-unranked .hero__name {
        color: var(--unranked-text-primary) !important;
        background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 50%, #94a3b8 100%) !important;
        -webkit-background-clip: text !important;
        -webkit-text-fill-color: transparent !important;
        background-clip: text !important;
    }

    .tier-unranked .hero__specialty {
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .hero__subspecialty {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .hero__location {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .hero__location svg {
        color: var(--accent) !important;
        opacity: 0.7;
    }

    /* Metrics - Glassmorphism cards with blue tint */
    .tier-unranked .metric {
        background: rgba(15, 23, 42, 0.8) !important;
        border: 1px solid var(--unranked-border) !important;
        backdrop-filter: blur(12px);
    }

    .tier-unranked .metric:hover {
        background: rgba(30, 41, 59, 0.9) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.3), 0 0 20px rgba(96, 165, 250, 0.1);
    }

    .tier-unranked .metric__value {
        color: var(--unranked-text-primary) !important;
        font-weight: 700;
    }

    .tier-unranked .metric__label {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .metric--impact {
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.1) 0%, rgba(15, 23, 42, 0.9) 100%) !important;
        border-color: rgba(96, 165, 250, 0.25) !important;
    }

    .tier-unranked .metric--impact .metric__value {
        color: #60a5fa !important;
    }

    /* Hero Actions */
    .tier-unranked .hero__actions {
        border-top-color: var(--unranked-border) !important;
    }

    .tier-unranked .btn--outline {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .btn--outline:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.4) !important;
        color: var(--unranked-text-primary) !important;
    }

    /* Content Wrapper */
    .tier-unranked .content-wrapper {
        background: linear-gradient(180deg, #020617 0%, #0a0a12 100%);
    }

    /* Cards - Deep slate with visible borders */
    .tier-unranked .card {
        background: var(--unranked-surface) !important;
        border: 1px solid var(--unranked-border) !important;
        box-shadow: 0 4px 24px rgba(0, 0, 0, 0.4);
    }

    .tier-unranked .card:hover {
        background: var(--unranked-surface-hover) !important;
        border-color: rgba(96, 165, 250, 0.25) !important;
        box-shadow: 0 8px 40px rgba(0, 0, 0, 0.5), 0 0 30px rgba(96, 165, 250, 0.05);
    }

    .tier-unranked .card--overview {
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.05) 0%, var(--unranked-surface) 100%) !important;
        border-color: rgba(96, 165, 250, 0.15) !important;
    }

    .tier-unranked .card--overview::before {
        background: linear-gradient(180deg, #60a5fa 0%, rgba(96, 165, 250, 0.3) 100%) !important;
    }

    .tier-unranked .card__title {
        color: var(--unranked-text-primary) !important;
        border-bottom-color: var(--unranked-border) !important;
    }

    .tier-unranked .card__title svg {
        color: #60a5fa !important;
    }

    .tier-unranked .card__summary {
        color: var(--unranked-text-secondary) !important;
        line-height: 1.8;
    }

    /* Biography */
    .tier-unranked .bio-text {
        color: var(--unranked-text-secondary) !important;
        line-height: 1.85;
    }

    /* Prose content */
    .tier-unranked .prose,
    .tier-unranked .prose p,
    .tier-unranked .prose li,
    .tier-unranked .prose span,
    .tier-unranked .prose strong {
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .prose a {
        color: #60a5fa !important;
    }

    .tier-unranked .prose a:hover {
        color: #93c5fd !important;
    }

    /* Sidebar Cards */
    .tier-unranked .sidebar-card {
        background: var(--unranked-surface) !important;
        border: 1px solid var(--unranked-border) !important;
    }

    .tier-unranked .sidebar-card:hover {
        border-color: rgba(96, 165, 250, 0.25) !important;
    }

    .tier-unranked .sidebar-card__title {
        color: var(--unranked-text-primary) !important;
    }

    /* Fact rows */
    .tier-unranked .fact-row dt {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .fact-row dd {
        color: var(--unranked-text-primary) !important;
    }

    /* Profile completeness */
    .tier-unranked .completeness-text {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .completeness-bar {
        background: rgba(96, 165, 250, 0.2) !important;
    }

    .tier-unranked .completeness-fill {
        background: linear-gradient(90deg, #60a5fa, #3b82f6) !important;
    }

    /* Credential links */
    .tier-unranked .credential-link {
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .credential-link:hover {
        color: #60a5fa !important;
    }

    /* Suggest card */
    .tier-unranked .suggest-card {
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.08) 0%, var(--unranked-surface) 100%) !important;
        border-color: rgba(96, 165, 250, 0.2) !important;
    }

    .tier-unranked .suggest-title {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .suggest-text {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .suggest-icon svg {
        color: #60a5fa !important;
    }

    .tier-unranked .suggest-option {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .suggest-option:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .suggest-note {
        color: var(--unranked-text-muted) !important;
    }

    /* Affiliations */
    .tier-unranked .affiliation-card {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .affiliation-card:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    .tier-unranked .affiliation-card__name {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .affiliation-card__role {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .affiliation-card__location {
        color: var(--unranked-text-muted) !important;
    }

    /* Research stats */
    .tier-unranked .research-stat {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .research-stat__value {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .research-stat__label {
        color: var(--unranked-text-muted) !important;
    }

    /* Publications */
    .tier-unranked .publication-card {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .publication-card:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    .tier-unranked .pub-title,
    .tier-unranked .publication__title {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .pub-authors,
    .tier-unranked .pub-journal,
    .tier-unranked .publication__meta {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .pub-link {
        color: #60a5fa !important;
    }

    .tier-unranked .pub-link:hover {
        color: #93c5fd !important;
    }

    .tier-unranked .pub-badge {
        background: rgba(96, 165, 250, 0.15) !important;
        color: #60a5fa !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    /* Institution cards */
    .tier-unranked .institution-card {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .institution-card:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    .tier-unranked .institution-card__name {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .institution-card__location {
        color: var(--unranked-text-muted) !important;
    }

    /* Talks */
    .tier-unranked .talk-card {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .talk-card:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    .tier-unranked .talk-card__title {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .talk-card__venue,
    .tier-unranked .talk-card__date {
        color: var(--unranked-text-muted) !important;
    }

    /* Awards */
    .tier-unranked .award-card {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .award-card:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    .tier-unranked .award-name {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .award-year,
    .tier-unranked .award-issuer {
        color: var(--unranked-text-muted) !important;
    }

    /* Timeline */
    .tier-unranked .timeline-item {
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .timeline-dot {
        background: #60a5fa !important;
        box-shadow: 0 0 12px rgba(96, 165, 250, 0.4) !important;
    }

    .tier-unranked .timeline-year {
        color: #60a5fa !important;
    }

    .tier-unranked .timeline-title {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .timeline-description {
        color: var(--unranked-text-muted) !important;
    }

    /* Tabs */
    .tier-unranked .tab-btn {
        color: var(--unranked-text-muted) !important;
        border-color: transparent !important;
    }

    .tier-unranked .tab-btn:hover {
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .tab-btn.active {
        color: #60a5fa !important;
        border-color: #60a5fa !important;
        background: rgba(96, 165, 250, 0.1) !important;
    }

    /* AI Content sections */
    .tier-unranked .ai-section {
        background: var(--unranked-surface) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .ai-section__title {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .ai-section__content {
        color: var(--unranked-text-secondary) !important;
    }

    /* Verification badges */
    .tier-unranked .verify-badge {
        background: rgba(96, 165, 250, 0.15) !important;
        color: #60a5fa !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    /* Portrait frame */
    .tier-unranked .hero__frame {
        border-color: var(--unranked-border) !important;
        box-shadow: 0 0 40px rgba(96, 165, 250, 0.1) !important;
    }

    .tier-unranked .hero__frame::before {
        background: linear-gradient(135deg, rgba(96, 165, 250, 0.2), transparent) !important;
    }

    .tier-unranked .hero__initials {
        background: linear-gradient(135deg, #1e293b 0%, #0f172a 100%) !important;
        color: #60a5fa !important;
    }

    /* Similar doctors section */
    .tier-unranked .similar-card {
        background: rgba(15, 23, 42, 0.6) !important;
        border-color: var(--unranked-border) !important;
    }

    .tier-unranked .similar-card:hover {
        background: rgba(30, 41, 59, 0.8) !important;
        border-color: rgba(96, 165, 250, 0.3) !important;
    }

    .tier-unranked .similar-card__name {
        color: var(--unranked-text-primary) !important;
    }

    .tier-unranked .similar-card__specialty {
        color: var(--unranked-text-muted) !important;
    }

    /* Quote/citation styling */
    .tier-unranked blockquote {
        border-left-color: #60a5fa !important;
        background: rgba(96, 165, 250, 0.05) !important;
        color: var(--unranked-text-secondary) !important;
    }

    /* Links within content */
    .tier-unranked a:not(.btn):not(.nav-link) {
        color: #60a5fa;
    }

    .tier-unranked a:not(.btn):not(.nav-link):hover {
        color: #93c5fd;
    }

    /* Section headers */
    .tier-unranked h2,
    .tier-unranked h3,
    .tier-unranked h4 {
        color: var(--unranked-text-primary) !important;
    }

    /* Lists */
    .tier-unranked ul li,
    .tier-unranked ol li {
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked ul li::marker {
        color: #60a5fa !important;
    }

    /* Embed and share buttons */
    .tier-unranked .embed-btn,
    .tier-unranked .share-btn {
        background: rgba(15, 23, 42, 0.8) !important;
        border-color: var(--unranked-border) !important;
        color: var(--unranked-text-secondary) !important;
    }

    .tier-unranked .embed-btn:hover,
    .tier-unranked .share-btn:hover {
        background: rgba(30, 41, 59, 0.9) !important;
        border-color: rgba(96, 165, 250, 0.4) !important;
        color: var(--unranked-text-primary) !important;
    }

    /* Knowledge graph nodes */
    .tier-unranked .kg-node {
        background: var(--unranked-surface) !important;
        border-color: var(--unranked-border) !important;
        color: var(--unranked-text-secondary) !important;
    }

    /* Empty states */
    .tier-unranked .empty-state {
        color: var(--unranked-text-muted) !important;
    }

    .tier-unranked .empty-state__icon {
        color: #60a5fa !important;
        opacity: 0.5;
    }

    /* Loading skeletons */
    .tier-unranked .skeleton {
        background: linear-gradient(90deg, var(--unranked-surface) 25%, rgba(96, 165, 250, 0.1) 50%, var(--unranked-surface) 75%) !important;
    }

    /* Scrollbar styling */
    .tier-unranked ::-webkit-scrollbar-track {
        background: var(--unranked-surface);
    }

    .tier-unranked ::-webkit-scrollbar-thumb {
        background: rgba(96, 165, 250, 0.3);
        border-radius: 4px;
    }

    .tier-unranked ::-webkit-scrollbar-thumb:hover {
        background: rgba(96, 165, 250, 0.5);
    }

    .container {
        max-width: 1280px;
        margin: 0 auto;
        padding: 0 1.5rem;
    }

    /* ═══════════════════ HERO SECTION ═══════════════════ */
    .hero {
        position: relative;
        padding: 5rem 0 4rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        overflow: hidden;
    }

    /* Ambient glow behind hero */
    .hero::before {
        content: '';
        position: absolute;
        top: -50%;
        left: 50%;
        transform: translateX(-50%);
        width: 100%;
        max-width: 800px;
        height: 600px;
        background: radial-gradient(ellipse, rgba(var(--accent-rgb), 0.08) 0%, transparent 70%);
        pointer-events: none;
    }

    .hero__container {
        position: relative;
        display: grid;
        grid-template-columns: auto 1fr;
        gap: 4rem;
        align-items: start;
        max-width: 1280px;
        margin: 0 auto;
        padding: 0 2rem;
    }

    .hero__portrait-col {
        display: flex;
        flex-direction: column;
        align-items: center;
        gap: 1.25rem;
    }

    .hero__frame {
        position: relative;
        width: 260px;
        height: 260px;
        border-radius: 24px;
        overflow: hidden;
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.1) 0%, transparent 50%);
        padding: 3px;
        transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .hero__frame::before {
        content: '';
        position: absolute;
        inset: 0;
        border-radius: 24px;
        padding: 2px;
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.5), rgba(var(--accent-rgb), 0.1), transparent);
        -webkit-mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        mask: linear-gradient(#fff 0 0) content-box, linear-gradient(#fff 0 0);
        -webkit-mask-composite: xor;
        mask-composite: exclude;
    }

    .hero__frame:hover {
        transform: translateY(-4px);
        box-shadow: 0 30px 60px -12px rgba(var(--accent-rgb), 0.25);
    }

    .hero__frame--titan {
        box-shadow: 0 0 80px rgba(var(--accent-rgb), 0.2), 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        animation: titanPulse 4s ease-in-out infinite;
    }

    .hero__frame--elite {
        box-shadow: 0 0 60px rgba(var(--accent-rgb), 0.15), 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    .hero__frame--master {
        box-shadow: 0 0 50px rgba(var(--accent-rgb), 0.12), 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    .hero__frame--unranked {
        box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
    }

    @keyframes titanPulse {
        0%, 100% { box-shadow: 0 0 80px rgba(var(--accent-rgb), 0.2), 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
        50% { box-shadow: 0 0 120px rgba(var(--accent-rgb), 0.35), 0 25px 50px -12px rgba(0, 0, 0, 0.5); }
    }

    .hero__image {
        width: 100%;
        height: 100%;
        object-fit: cover;
        border-radius: 22px;
    }

    .hero__initials {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #1a1a2e 0%, #0f0f1a 100%);
        color: rgba(var(--accent-rgb), 0.6);
        border-radius: 22px;
        letter-spacing: -0.05em;
    }

    .hero__badges {
        display: flex;
        gap: 0.5rem;
    }

    .verify-badge {
        display: inline-flex;
        align-items: center;
        gap: 5px;
        padding: 6px 12px;
        background: rgba(16, 185, 129, 0.08);
        border: 1px solid rgba(16, 185, 129, 0.2);
        border-radius: 8px;
        font-size: 0.7rem;
        font-weight: 600;
        color: #34d399;
        text-decoration: none;
        transition: all 0.2s;
        backdrop-filter: blur(8px);
    }

    .verify-badge:hover {
        background: rgba(16, 185, 129, 0.12);
        border-color: rgba(16, 185, 129, 0.3);
        transform: translateY(-1px);
    }

    /* Hero Info Column */
    .hero__info-col {
        display: flex;
        flex-direction: column;
        gap: 0.875rem;
        padding-top: 0.5rem;
    }

    .hero__tier-row {
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }

    .historical-tag {
        padding: 5px 12px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        font-size: 0.7rem;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #94a3b8;
    }

    .hero__name {
        font-family: var(--font-serif, Georgia, serif);
        font-size: clamp(2.25rem, 4.5vw, 3.25rem);
        font-weight: 700;
        line-height: 1.1;
        letter-spacing: -0.03em;
        color: #fafafa;
        margin: 0;
        background: linear-gradient(135deg, #ffffff 0%, #e2e8f0 100%);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }

    .hero__specialty {
        font-size: 1.125rem;
        font-weight: 500;
        color: #e2e8f0;
        margin: 0;
    }

    .hero__subspecialty {
        color: #94a3b8;
        font-weight: 400;
    }

    .hero__location {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.9rem;
        color: #94a3b8;
        margin: 0;
        padding: 6px 0;
    }

    .hero__location svg {
        color: rgba(var(--accent-rgb), 0.7);
    }

    /* Hero Metrics - Glass Cards */
    .hero__metrics {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 1.5rem;
    }

    .metric {
        position: relative;
        display: flex;
        flex-direction: column;
        padding: 1rem 1.25rem;
        background: rgba(255, 255, 255, 0.02);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 14px;
        min-width: 90px;
        text-align: center;
        backdrop-filter: blur(12px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .metric:hover {
        background: rgba(255, 255, 255, 0.04);
        border-color: rgba(var(--accent-rgb), 0.2);
        transform: translateY(-2px);
    }

    .metric__value {
        font-family: var(--font-mono, 'JetBrains Mono', monospace);
        font-size: 1.5rem;
        font-weight: 700;
        color: #fafafa;
        line-height: 1.2;
        letter-spacing: -0.02em;
    }

    .metric__label {
        font-size: 0.65rem;
        text-transform: uppercase;
        letter-spacing: 0.08em;
        color: #71717a;
        margin-top: 4px;
        font-weight: 500;
    }

    .metric--impact {
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.08) 0%, rgba(var(--accent-rgb), 0.02) 100%);
        border-color: rgba(var(--accent-rgb), 0.15);
    }

    .metric--impact .metric__value {
        color: rgba(var(--accent-rgb), 1);
    }

    /* Hero Actions */
    .hero__actions {
        display: flex;
        flex-wrap: wrap;
        gap: 0.75rem;
        margin-top: 2rem;
        padding-top: 1.75rem;
        border-top: 1px solid rgba(255, 255, 255, 0.04);
    }

    .hero__actions > * {
        flex-shrink: 0;
    }

    /* Button styling */
    .btn--outline {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        height: 44px;
        padding: 0 18px;
        background: rgba(255, 255, 255, 0.03);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 12px;
        color: #a1a1aa;
        font-size: 0.875rem;
        font-weight: 500;
        text-decoration: none;
        transition: all 0.2s;
        cursor: pointer;
    }

    .btn--outline:hover {
        background: rgba(255, 255, 255, 0.06);
        border-color: rgba(255, 255, 255, 0.12);
        color: #fafafa;
    }

    .tier-unranked .hero__actions {
        border-top-color: rgba(255, 255, 255, 0.06);
    }

    /* ═══════════════════ AWARDS RIBBON ═══════════════════ */
    .awards-ribbon-section {
        position: relative;
        padding: 1.25rem 0;
        background: linear-gradient(180deg, rgba(0, 0, 0, 0.3) 0%, rgba(0, 0, 0, 0.15) 100%);
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }

    /* ═══════════════════ CONTENT LAYOUT ═══════════════════ */
    .content-wrapper {
        padding: 2.5rem 0 4rem;
    }

    .content-grid {
        display: grid;
        grid-template-columns: 1fr 320px;
        gap: 2rem;
        align-items: start;
    }

    /* ═══════════════════ CARDS ═══════════════════ */
    .card {
        position: relative;
        background: #111117;
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 16px;
        padding: 1.75rem;
        margin-bottom: var(--section-gap);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .card:hover {
        border-color: rgba(255, 255, 255, 0.08);
        box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
    }

    .card--overview {
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.03) 0%, #111117 100%);
        border-color: rgba(var(--accent-rgb), 0.1);
    }

    .card--overview::before {
        content: '';
        position: absolute;
        left: 0;
        top: 0;
        bottom: 0;
        width: 3px;
        background: linear-gradient(180deg, var(--accent) 0%, rgba(var(--accent-rgb), 0.3) 100%);
        border-radius: 16px 0 0 16px;
    }

    .card__title {
        display: flex;
        align-items: center;
        gap: 0.625rem;
        font-size: 1rem;
        font-weight: 600;
        margin: 0 0 1.25rem;
        padding-bottom: 0.875rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.05);
        color: #fafafa;
        letter-spacing: -0.01em;
    }

    .card__title svg {
        color: var(--accent, #71717a);
        opacity: 0.8;
        width: 18px;
        height: 18px;
    }

    .card__summary {
        font-size: 1rem;
        line-height: 1.7;
        color: #a1a1aa;
        margin: 0;
    }

    .prose {
        font-size: 0.9375rem;
        line-height: 1.75;
        color: #a1a1aa;
    }

    .prose p {
        margin-bottom: 1rem;
    }

    .prose p:last-child {
        margin-bottom: 0;
    }

    .bio-text {
        color: #a1a1aa;
        line-height: 1.75;
    }

    /* ═══════════════════ AFFILIATIONS ═══════════════════ */
    .affiliations-grid {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .affiliation-card {
        position: relative;
        display: flex;
        align-items: center;
        gap: 1rem;
        padding: 1rem 1.125rem;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.025) 0%, rgba(255, 255, 255, 0.01) 100%);
        border: 1px solid rgba(255, 255, 255, 0.05);
        border-radius: 14px;
        text-decoration: none;
        color: inherit;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
    }

    .affiliation-card::before {
        content: '';
        position: absolute;
        inset: 0;
        background: linear-gradient(90deg, rgba(var(--accent-rgb), 0.03) 0%, transparent 50%);
        opacity: 0;
        transition: opacity 0.25s;
    }

    .affiliation-card:hover {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
        border-color: rgba(var(--accent-rgb), 0.15);
        transform: translateX(4px);
        box-shadow: 0 8px 24px -8px rgba(0, 0, 0, 0.25);
    }

    .affiliation-card:hover::before {
        opacity: 1;
    }

    .affiliation-card__logo {
        position: relative;
        width: 52px;
        height: 52px;
        flex-shrink: 0;
        border-radius: 12px;
        overflow: hidden;
        background: white;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
    }

    .affiliation-card__logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        padding: 6px;
        background: white;
    }

    .affiliation-card__initials {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        font-weight: 700;
        color: white;
        text-transform: uppercase;
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.8) 0%, rgba(var(--accent-rgb), 0.6) 100%);
    }

    .affiliation-card__info {
        flex: 1;
        position: relative;
    }

    .affiliation-card__name {
        font-size: 0.9rem;
        font-weight: 600;
        color: #e5e7eb;
        margin: 0 0 3px;
        letter-spacing: -0.01em;
    }

    .affiliation-card__role {
        font-size: 0.75rem;
        color: #71717a;
        margin: 0;
        font-weight: 500;
    }

    .affiliation-card__arrow {
        position: relative;
        color: #52525b;
        opacity: 0;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .affiliation-card:hover .affiliation-card__arrow {
        opacity: 1;
        transform: translateX(4px);
        color: rgba(var(--accent-rgb), 0.8);
    }

    /* ═══════════════════ RESEARCH SECTION ═══════════════════ */
    .research-stats {
        display: grid;
        grid-template-columns: repeat(auto-fit, minmax(130px, 1fr));
        gap: 0.875rem;
        margin-bottom: 2rem;
    }

    .research-stat {
        position: relative;
        flex: 1;
        min-width: 120px;
        padding: 1.5rem 1.25rem;
        background: linear-gradient(145deg, rgba(255, 255, 255, 0.03) 0%, rgba(255, 255, 255, 0.01) 100%);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 14px;
        text-align: center;
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
    }

    .research-stat::before {
        content: '';
        position: absolute;
        inset: 0;
        background: radial-gradient(circle at 50% 0%, rgba(var(--accent-rgb), 0.08) 0%, transparent 60%);
        opacity: 0;
        transition: opacity 0.3s;
    }

    .research-stat:hover {
        transform: translateY(-3px);
        border-color: rgba(var(--accent-rgb), 0.2);
        box-shadow: 0 12px 24px -8px rgba(0, 0, 0, 0.3);
    }

    .research-stat:hover::before {
        opacity: 1;
    }

    .research-stat--highlight {
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.1) 0%, rgba(var(--accent-rgb), 0.03) 100%);
        border-color: rgba(var(--accent-rgb), 0.25);
    }

    .research-stat__value {
        position: relative;
        display: block;
        font-family: var(--font-mono);
        font-size: 1.75rem;
        font-weight: 700;
        color: #fafafa;
        line-height: 1.2;
        letter-spacing: -0.02em;
    }

    .research-stat__label {
        position: relative;
        font-size: 0.65rem;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #71717a;
        margin-top: 6px;
        font-weight: 500;
    }

    .journals-section {
        margin-bottom: 2rem;
    }

    .journals-title, .publications-title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #52525b;
        margin: 0 0 1rem;
    }

    .journals-title::after, .publications-title::after {
        content: '';
        flex: 1;
        height: 1px;
        background: linear-gradient(90deg, rgba(255, 255, 255, 0.06), transparent);
    }

    .journals-list {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }

    .journal-tag {
        position: relative;
        padding: 7px 14px;
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.1) 0%, rgba(59, 130, 246, 0.05) 100%);
        border: 1px solid rgba(59, 130, 246, 0.2);
        border-radius: 100px;
        font-size: 0.75rem;
        font-weight: 550;
        color: #60a5fa;
        transition: all 0.2s;
    }

    .journal-tag:hover {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.15) 0%, rgba(59, 130, 246, 0.08) 100%);
        border-color: rgba(59, 130, 246, 0.3);
        transform: translateY(-1px);
    }

    /* Publications List */
    .publications-list {
        display: flex;
        flex-direction: column;
        gap: 0.875rem;
    }

    .publication {
        position: relative;
        padding: 1.25rem 1.25rem 1.25rem 1.5rem;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.025) 0%, rgba(255, 255, 255, 0.01) 100%);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .publication::before {
        content: '';
        position: absolute;
        left: 0;
        top: 12px;
        bottom: 12px;
        width: 2px;
        background: linear-gradient(180deg, rgba(var(--accent-rgb), 0.6) 0%, rgba(var(--accent-rgb), 0.2) 100%);
        border-radius: 2px;
        opacity: 0;
        transition: opacity 0.25s;
    }

    .publication:hover {
        border-color: rgba(var(--accent-rgb), 0.15);
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
        transform: translateX(2px);
        box-shadow: 0 8px 24px -8px rgba(0, 0, 0, 0.25);
    }

    .publication:hover::before {
        opacity: 1;
    }

    .publication__title {
        display: block;
        font-weight: 550;
        color: #e5e7eb;
        text-decoration: none;
        margin-bottom: 0.625rem;
        line-height: 1.5;
        font-size: 0.9375rem;
        letter-spacing: -0.01em;
        transition: color 0.2s;
    }

    .publication__title:hover {
        color: rgba(var(--accent-rgb), 1);
    }

    .publication__meta {
        display: flex;
        flex-wrap: wrap;
        gap: 0.875rem;
        font-size: 0.8rem;
        color: #71717a;
    }

    .publication__citations {
        display: inline-flex;
        align-items: center;
        gap: 4px;
        color: rgba(var(--accent-rgb), 0.9);
        font-weight: 600;
        font-size: 0.75rem;
        padding: 2px 8px;
        background: rgba(var(--accent-rgb), 0.1);
        border-radius: 6px;
    }

    .publication__links {
        display: flex;
        gap: 0.5rem;
        margin-top: 0.875rem;
    }

    .pub-link {
        display: inline-flex;
        align-items: center;
        gap: 0.35rem;
        padding: 5px 12px;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.08);
        border-radius: 8px;
        font-size: 0.7rem;
        font-weight: 500;
        color: #a1a1aa;
        text-decoration: none;
        transition: all 0.2s;
    }

    .pub-link:hover {
        background: rgba(255, 255, 255, 0.08);
        border-color: rgba(255, 255, 255, 0.12);
        color: #fafafa;
        transform: translateY(-1px);
    }

    .pub-link--pubmed {
        background: rgba(0, 102, 153, 0.08);
        border-color: rgba(0, 102, 153, 0.2);
        color: #38bdf8;
    }

    .pub-link--pubmed:hover {
        background: rgba(0, 102, 153, 0.15);
        border-color: rgba(0, 102, 153, 0.3);
    }

    .pub-link--oa {
        background: rgba(16, 185, 129, 0.08);
        border-color: rgba(16, 185, 129, 0.2);
        color: #34d399;
    }

    .pub-link--oa:hover {
        background: rgba(16, 185, 129, 0.15);
        border-color: rgba(16, 185, 129, 0.3);
    }

    /* Total Impact Metric */
    .metric--impact {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(16, 185, 129, 0.1));
        border-color: rgba(139, 92, 246, 0.3);
    }

    .metric--impact .metric__value {
        color: var(--accent-purple);
    }

    /* ═══════════════════ EXPERTISE TAGS ═══════════════════ */
    .expertise-container {
        display: flex;
        flex-direction: column;
        gap: 1.75rem;
    }

    .expertise-group__title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #52525b;
        margin: 0 0 0.875rem;
    }

    .expertise-group__title::after {
        content: '';
        flex: 1;
        height: 1px;
        background: linear-gradient(90deg, rgba(255, 255, 255, 0.06), transparent);
    }

    .tags {
        display: flex;
        flex-wrap: wrap;
        gap: 0.5rem;
    }

    .tag {
        position: relative;
        padding: 8px 16px;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 100px;
        font-size: 0.8rem;
        color: #a1a1aa;
        font-weight: 500;
        transition: all 0.2s cubic-bezier(0.4, 0, 0.2, 1);
        cursor: default;
    }

    .tag:hover {
        background: rgba(255, 255, 255, 0.06);
        border-color: rgba(255, 255, 255, 0.1);
        color: #e5e7eb;
        transform: translateY(-1px);
    }

    .tag--technique {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.12) 0%, rgba(139, 92, 246, 0.06) 100%);
        border-color: rgba(139, 92, 246, 0.25);
        color: #a78bfa;
        font-weight: 550;
    }

    .tag--technique:hover {
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.18) 0%, rgba(139, 92, 246, 0.1) 100%);
        border-color: rgba(139, 92, 246, 0.4);
        box-shadow: 0 4px 12px rgba(139, 92, 246, 0.15);
    }

    .tag--rare {
        background: linear-gradient(135deg, rgba(236, 72, 153, 0.12) 0%, rgba(236, 72, 153, 0.06) 100%);
        border-color: rgba(236, 72, 153, 0.25);
        color: #f472b6;
        font-weight: 550;
    }

    .tag--rare:hover {
        background: linear-gradient(135deg, rgba(236, 72, 153, 0.18) 0%, rgba(236, 72, 153, 0.1) 100%);
        border-color: rgba(236, 72, 153, 0.4);
        box-shadow: 0 4px 12px rgba(236, 72, 153, 0.15);
    }

    .tag--specialty {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.12) 0%, rgba(59, 130, 246, 0.06) 100%);
        border-color: rgba(59, 130, 246, 0.25);
        color: #60a5fa;
        font-weight: 550;
    }

    .tag--specialty:hover {
        background: linear-gradient(135deg, rgba(59, 130, 246, 0.18) 0%, rgba(59, 130, 246, 0.1) 100%);
        border-color: rgba(59, 130, 246, 0.4);
        box-shadow: 0 4px 12px rgba(59, 130, 246, 0.15);
    }

    .tag--condition {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.12) 0%, rgba(245, 158, 11, 0.06) 100%);
        border-color: rgba(245, 158, 11, 0.25);
        color: #fbbf24;
        font-weight: 550;
    }

    .tag--condition:hover {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.18) 0%, rgba(245, 158, 11, 0.1) 100%);
        border-color: rgba(245, 158, 11, 0.4);
        box-shadow: 0 4px 12px rgba(245, 158, 11, 0.15);
    }

    /* Talks & Lectures */
    .talks-list {
        display: flex;
        flex-direction: column;
        gap: 0.75rem;
    }

    .talk-card {
        position: relative;
        display: flex;
        gap: 1rem;
        padding: 1.125rem;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.025) 0%, rgba(255, 255, 255, 0.01) 100%);
        border-radius: 12px;
        border: 1px solid rgba(255, 255, 255, 0.05);
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .talk-card:hover {
        border-color: rgba(var(--accent-rgb), 0.15);
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
        transform: translateY(-2px);
        box-shadow: 0 8px 24px -8px rgba(0, 0, 0, 0.25);
    }

    .talk-card__year {
        flex-shrink: 0;
        width: 52px;
        height: 52px;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.12) 0%, rgba(var(--accent-rgb), 0.06) 100%);
        border: 1px solid rgba(var(--accent-rgb), 0.2);
        border-radius: 10px;
        font-family: var(--font-mono);
        font-size: 0.85rem;
        font-weight: 700;
        color: rgba(var(--accent-rgb), 0.9);
    }

    .talk-card__content {
        flex: 1;
        display: flex;
        flex-direction: column;
        justify-content: center;
    }

    .talk-card__title {
        font-size: 0.9rem;
        font-weight: 600;
        color: #e5e7eb;
        margin: 0 0 0.35rem;
        line-height: 1.4;
        letter-spacing: -0.01em;
    }

    .talk-card__event {
        font-size: 0.8rem;
        color: #71717a;
        margin: 0;
        font-weight: 500;
    }

    /* ═══════════════════ SIDEBAR ═══════════════════ */
    .sidebar-col {
        position: relative;
    }

    .sidebar-sticky {
        position: sticky;
        top: 2rem;
        display: flex;
        flex-direction: column;
        gap: 1.25rem;
    }

    .sidebar-card {
        position: relative;
        background: linear-gradient(145deg, rgba(20, 20, 35, 0.95) 0%, rgba(17, 17, 27, 0.9) 100%);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 18px;
        padding: 1.5rem;
        backdrop-filter: blur(16px);
        transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        overflow: hidden;
    }

    .sidebar-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 1px;
        background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.1), transparent);
    }

    .sidebar-card:hover {
        border-color: rgba(255, 255, 255, 0.1);
        transform: translateY(-2px);
        box-shadow: 0 16px 32px -8px rgba(0, 0, 0, 0.3);
    }

    .sidebar-card__title {
        display: flex;
        align-items: center;
        gap: 0.5rem;
        font-size: 0.7rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.1em;
        color: #71717a;
        margin: 0 0 1.125rem;
        padding-bottom: 0.75rem;
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }

    .facts-list {
        margin: 0;
    }

    .fact-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.625rem 0;
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
        font-size: 0.8rem;
        transition: all 0.2s;
    }

    .fact-row:last-child {
        border-bottom: none;
    }

    .fact-row:hover {
        background: rgba(255, 255, 255, 0.02);
        margin: 0 -0.5rem;
        padding-left: 0.5rem;
        padding-right: 0.5rem;
        border-radius: 6px;
    }

    .fact-row dt {
        color: #71717a;
        font-weight: 500;
    }

    .fact-row dd {
        margin: 0;
        color: #e5e7eb;
        text-align: right;
        font-weight: 600;
        font-size: 0.8rem;
    }

    /* Credentials Card */
    .credential-link {
        display: flex;
        align-items: center;
        gap: 0.875rem;
        padding: 0.875rem 1rem;
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
        border: 1px solid rgba(255, 255, 255, 0.06);
        border-radius: 12px;
        margin-bottom: 0.6rem;
        text-decoration: none;
        color: #d1d5db;
        font-size: 0.85rem;
        font-weight: 500;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .credential-link:hover {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.06) 0%, rgba(255, 255, 255, 0.04) 100%);
        border-color: rgba(255, 255, 255, 0.1);
        transform: translateY(-1px);
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
    }

    .npi-icon {
        display: inline-flex;
        align-items: center;
        justify-content: center;
        width: 18px;
        height: 18px;
        font-size: 0.5rem;
        font-weight: 800;
        background: linear-gradient(135deg, #10b981, #059669);
        color: white;
        border-radius: 4px;
        box-shadow: 0 2px 4px rgba(16, 185, 129, 0.25);
    }

    /* Institution Card */
    .institution-link {
        display: flex;
        align-items: center;
        gap: 0.875rem;
        padding: 0.875rem 1rem;
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.1) 0%, rgba(var(--accent-rgb), 0.04) 100%);
        border: 1px solid rgba(var(--accent-rgb), 0.12);
        border-radius: 12px;
        text-decoration: none;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
    }

    .institution-link:hover {
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.15) 0%, rgba(var(--accent-rgb), 0.08) 100%);
        border-color: rgba(var(--accent-rgb), 0.25);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px -8px rgba(var(--accent-rgb), 0.2);
    }

    .institution-logo {
        width: 48px;
        height: 48px;
        flex-shrink: 0;
        border-radius: 10px;
        overflow: hidden;
        background: white;
        box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
    }

    .institution-logo img {
        width: 100%;
        height: 100%;
        object-fit: contain;
        padding: 4px;
    }

    .institution-initials {
        width: 100%;
        height: 100%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 0.9rem;
        font-weight: 700;
        color: white;
        text-transform: uppercase;
        background: linear-gradient(135deg, rgba(var(--accent-rgb), 0.9), rgba(var(--accent-rgb), 0.7));
    }

    .institution-info {
        display: flex;
        flex-direction: column;
        gap: 2px;
    }

    .institution-name {
        font-weight: 600;
        color: #e5e7eb;
        font-size: 0.875rem;
        letter-spacing: -0.01em;
    }

    .institution-role {
        font-size: 0.75rem;
        color: #71717a;
        font-weight: 500;
    }

    .institution-more {
        font-size: 0.75rem;
        color: #52525b;
        margin: 0.875rem 0 0;
        text-align: center;
        font-weight: 500;
    }

    /* Consultation Card */
    .consultation-card {
        background: linear-gradient(145deg, rgba(16, 185, 129, 0.1) 0%, rgba(139, 92, 246, 0.06) 50%, rgba(17, 17, 27, 0.95) 100%);
        border-color: rgba(16, 185, 129, 0.2);
    }

    .consultation-card::before {
        background: linear-gradient(90deg, transparent, rgba(16, 185, 129, 0.15), transparent);
    }

    .price-row {
        display: flex;
        justify-content: space-between;
        align-items: center;
        padding: 0.75rem 0;
        font-size: 0.875rem;
        color: #a1a1aa;
        border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    }

    .price-row:last-of-type {
        border-bottom: none;
    }

    .price-row span {
        font-weight: 500;
    }

    .price-row strong {
        color: #34d399;
        font-weight: 700;
        font-size: 0.9rem;
    }

    /* Suggest Card - Enhanced Premium Design */
    .suggest-card {
        text-align: center;
        background: linear-gradient(145deg, rgba(139, 92, 246, 0.08) 0%, rgba(16, 185, 129, 0.06) 50%, rgba(59, 130, 246, 0.06) 100%);
        border: 1px solid rgba(139, 92, 246, 0.25);
        border-radius: 20px;
        padding: 1.75rem;
        position: relative;
        overflow: hidden;
    }

    .suggest-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 3px;
        background: linear-gradient(90deg, #8b5cf6, #10b981, #3b82f6);
        opacity: 0.8;
    }

    .suggest-icon {
        width: 64px;
        height: 64px;
        margin: 0 auto 1.25rem;
        display: flex;
        align-items: center;
        justify-content: center;
        background: linear-gradient(135deg, rgba(139, 92, 246, 0.15), rgba(16, 185, 129, 0.1));
        border: 1px solid rgba(139, 92, 246, 0.2);
        border-radius: 16px;
        color: #a78bfa;
        box-shadow: 0 4px 20px rgba(139, 92, 246, 0.15);
    }

    .suggest-title {
        font-size: 1.1rem;
        font-weight: 700;
        color: #f3f4f6;
        margin: 0 0 0.75rem;
        letter-spacing: -0.01em;
    }

    .suggest-text {
        font-size: 0.85rem;
        color: #9ca3af;
        margin: 0 0 1.25rem;
        line-height: 1.6;
    }

    .suggest-options {
        display: grid;
        grid-template-columns: 1fr 1fr;
        gap: 0.6rem;
        margin-bottom: 1rem;
    }

    .suggest-option {
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.75rem 0.8rem;
        background: rgba(255, 255, 255, 0.04);
        border: 1px solid rgba(255, 255, 255, 0.1);
        border-radius: 12px;
        font-size: 0.75rem;
        font-weight: 600;
        color: #d1d5db;
        text-decoration: none;
        transition: all 0.25s ease;
    }

    .suggest-option:hover {
        background: rgba(139, 92, 246, 0.15);
        border-color: rgba(139, 92, 246, 0.4);
        color: #a78bfa;
        transform: translateY(-2px);
        box-shadow: 0 4px 12px rgba(139, 92, 246, 0.2);
    }

    .suggest-option__icon {
        font-size: 1.1rem;
    }

    .suggest-note {
        font-size: 0.7rem;
        color: #6b7280;
        margin: 0;
        display: flex;
        align-items: center;
        justify-content: center;
        gap: 0.4rem;
    }

    .suggest-note::before {
        content: '✓';
        color: #10b981;
        font-size: 0.65rem;
    }

    /* Profile Completeness Card */
    .completeness-card {
        background: linear-gradient(145deg, rgba(16, 185, 129, 0.06) 0%, rgba(139, 92, 246, 0.04) 50%, rgba(17, 17, 27, 0.95) 100%);
        border-color: rgba(16, 185, 129, 0.15);
    }

    .completeness-header {
        display: flex;
        justify-content: space-between;
        align-items: center;
        margin-bottom: 1rem;
    }

    .completeness-header .sidebar-card__title {
        margin: 0;
        padding-bottom: 0;
        border-bottom: none;
    }

    .completeness-badge {
        padding: 4px 12px;
        border-radius: 100px;
        font-size: 0.65rem;
        font-weight: 700;
        text-transform: uppercase;
        letter-spacing: 0.06em;
    }

    .completeness-badge--high {
        background: linear-gradient(135deg, rgba(16, 185, 129, 0.2), rgba(16, 185, 129, 0.1));
        color: #34d399;
        box-shadow: 0 2px 8px rgba(16, 185, 129, 0.15);
    }

    .completeness-badge--medium {
        background: linear-gradient(135deg, rgba(245, 158, 11, 0.2), rgba(245, 158, 11, 0.1));
        color: #fbbf24;
        box-shadow: 0 2px 8px rgba(245, 158, 11, 0.15);
    }

    .completeness-badge--low {
        background: linear-gradient(135deg, rgba(239, 68, 68, 0.2), rgba(239, 68, 68, 0.1));
        color: #f87171;
        box-shadow: 0 2px 8px rgba(239, 68, 68, 0.15);
    }

    .completeness-bar {
        height: 8px;
        background: rgba(255, 255, 255, 0.06);
        border-radius: 100px;
        overflow: hidden;
        box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.2);
    }

    .completeness-bar__fill {
        height: 100%;
        background: linear-gradient(90deg, #10b981 0%, #8b5cf6 50%, #a78bfa 100%);
        border-radius: 100px;
        transition: width 1.5s cubic-bezier(0.4, 0, 0.2, 1);
        box-shadow: 0 0 12px rgba(16, 185, 129, 0.4);
        position: relative;
    }

    .completeness-bar__fill::after {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: linear-gradient(90deg, transparent 0%, rgba(255, 255, 255, 0.2) 50%, transparent 100%);
        animation: shimmer 2s infinite;
    }

    @keyframes shimmer {
        0% { transform: translateX(-100%); }
        100% { transform: translateX(100%); }
    }

    .completeness-text {
        font-size: 0.75rem;
        color: #71717a;
        margin: 0.75rem 0 0;
        text-align: center;
        font-weight: 500;
    }

    /* ═══════════════════ BUTTONS ═══════════════════ */
    .btn {
        position: relative;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 0.5rem;
        padding: 0.875rem 1.75rem;
        border-radius: 12px;
        font-size: 0.875rem;
        font-weight: 600;
        text-decoration: none;
        cursor: pointer;
        transition: all 0.25s cubic-bezier(0.4, 0, 0.2, 1);
        border: none;
        letter-spacing: -0.01em;
    }

    .btn--outline {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.04) 0%, rgba(255, 255, 255, 0.02) 100%);
        border: 1px solid rgba(255, 255, 255, 0.08);
        color: #a1a1aa;
    }

    .btn--outline:hover {
        background: linear-gradient(135deg, rgba(255, 255, 255, 0.08) 0%, rgba(255, 255, 255, 0.04) 100%);
        border-color: rgba(255, 255, 255, 0.15);
        color: #fafafa;
        transform: translateY(-2px);
        box-shadow: 0 8px 16px -4px rgba(0, 0, 0, 0.2);
    }

    .btn--primary {
        background: linear-gradient(135deg, #8b5cf6 0%, #7c3aed 100%);
        color: white;
        box-shadow: 0 4px 12px rgba(139, 92, 246, 0.25);
    }

    .btn--primary:hover {
        background: linear-gradient(135deg, #9d74f7 0%, #8b5cf6 100%);
        transform: translateY(-2px);
        box-shadow: 0 8px 20px rgba(139, 92, 246, 0.35);
    }

    .btn--primary:active {
        transform: translateY(0);
    }

    .btn--text {
        background: transparent;
        color: #a78bfa;
        padding: 0.5rem 0;
    }

    .btn--text:hover {
        color: #c4b5fd;
    }

    .btn--full {
        width: 100%;
        margin-top: 1.125rem;
    }

    .btn--small {
        padding: 0.5rem 1rem;
        font-size: 0.8rem;
        border-radius: 10px;
    }

    /* ═══════════════════ RESPONSIVE ═══════════════════ */
    @media (max-width: 1024px) {
        .content-grid {
            grid-template-columns: 1fr;
        }

        .sidebar-col {
            order: -1;
        }

        .sidebar-sticky {
            position: static;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 1rem;
        }
    }

    @media (max-width: 768px) {
        .hero__container {
            grid-template-columns: 1fr;
            text-align: center;
            gap: 2rem;
        }

        .hero__portrait-col {
            order: 0;
        }

        .hero__info-col {
            align-items: center;
        }

        .hero__frame {
            width: 200px;
            height: 200px;
        }

        .hero__name {
            font-size: 2rem;
        }

        .hero__metrics {
            justify-content: center;
        }

        .hero__actions {
            justify-content: center;
        }

        .card {
            padding: 1.5rem;
        }

        .metric {
            padding: 0.75rem 1rem;
            min-width: 80px;
        }

        .metric__value {
            font-size: 1.25rem;
        }
    }

    @media (max-width: 480px) {
        .hero {
            padding: 2.5rem 0 2rem;
        }

        .hero__frame {
            width: 160px;
            height: 160px;
        }

        .hero__initials {
            font-size: 3.5rem;
        }

        .research-stats {
            flex-direction: column;
        }

        .research-stat {
            min-width: auto;
        }
    }

    /* ═══════════════════ ANIMATIONS ═══════════════════ */
    @keyframes countUp {
        from { opacity: 0; transform: translateY(10px); }
        to { opacity: 1; transform: translateY(0); }
    }

    @keyframes fadeInUp {
        from {
            opacity: 0;
            transform: translateY(20px);
        }
        to {
            opacity: 1;
            transform: translateY(0);
        }
    }

    @keyframes glow {
        0%, 100% { box-shadow: 0 0 20px rgba(var(--accent-rgb), 0.15); }
        50% { box-shadow: 0 0 40px rgba(var(--accent-rgb), 0.25); }
    }

    /* Section entrance animations */
    .card {
        animation: fadeInUp 0.5s ease-out backwards;
    }

    .card:nth-child(1) { animation-delay: 0.1s; }
    .card:nth-child(2) { animation-delay: 0.2s; }
    .card:nth-child(3) { animation-delay: 0.3s; }
    .card:nth-child(4) { animation-delay: 0.4s; }
    .card:nth-child(5) { animation-delay: 0.5s; }

    .sidebar-card {
        animation: fadeInUp 0.5s ease-out backwards;
    }

    .sidebar-card:nth-child(1) { animation-delay: 0.15s; }
    .sidebar-card:nth-child(2) { animation-delay: 0.25s; }
    .sidebar-card:nth-child(3) { animation-delay: 0.35s; }
    .sidebar-card:nth-child(4) { animation-delay: 0.45s; }

    /* Metric hover glow */
    .metric:hover {
        animation: glow 2s ease-in-out infinite;
    }

    /* Reduce motion for accessibility */
    @media (prefers-reduced-motion: reduce) {
        .card,
        .sidebar-card {
            animation: none;
        }

        .metric:hover {
            animation: none;
        }

        .completeness-bar__fill::after {
            animation: none;
        }

        .hero__frame--titan {
            animation: none;
        }
    }
</style>

<script>
    // Intersection Observer for Counters
    const observerOptions = {
        threshold: 0.1,
        rootMargin: "0px"
    };

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                const el = entry.target as HTMLElement;
                startCounter(el);
                observer.unobserve(el);
            }
        });
    }, observerOptions);

    document.querySelectorAll('.js-counter').forEach(el => observer.observe(el));

    function startCounter(el: HTMLElement) {
        const target = parseInt(el.dataset.target || '0');
        if (!target) return;

        const duration = 2000; // 2 seconds
        const start = 0;
        const startTime = performance.now();
        const isLive = el.dataset.liveIncrement === "true";

        function update(currentTime: number) {
            const elapsed = currentTime - startTime;
            const progress = Math.min(elapsed / duration, 1);
            
            // Ease out quart
            const ease = 1 - Math.pow(1 - progress, 4);
            
            const current = Math.floor(start + (target - start) * ease);
            el.textContent = current.toLocaleString();

            if (progress < 1) {
                requestAnimationFrame(update);
            } else {
                el.textContent = target.toLocaleString();
                if (isLive) {
                    startLiveIncrement(el, target);
                }
            }
        }

        requestAnimationFrame(update);
    }

    function startLiveIncrement(el: HTMLElement, startValue: number) {
        let currentValue = startValue;
        
        // Random increment between 5s and 15s
        function scheduleNext() {
            const delay = 5000 + Math.random() * 10000;
            setTimeout(() => {
                currentValue++;
                el.textContent = currentValue.toLocaleString();
                
                // Add a subtle highlight effect
                el.style.color = '#10b981'; // Green flash
                el.style.transition = 'color 0.3s';
                setTimeout(() => {
                    el.style.color = '';
                }, 300);

                scheduleNext();
            }, delay);
        }

        scheduleNext();
    }
</script>

<script>
    // Show more publications toggle
    document.addEventListener('DOMContentLoaded', () => {
        const showMoreBtns = document.querySelectorAll('.show-more-btn');
        showMoreBtns.forEach(btn => {
            btn.addEventListener('click', () => {
                // Could expand to show all publications
                // For now, link to full publications page
                window.location.hash = 'publications';
            });
        });
    });
</script>
